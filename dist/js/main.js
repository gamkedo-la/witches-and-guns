(()=>{"use strict";const t={id:"gameCanvas",canvas:null,context:null},e=20,i=32,s=14,o=39,a=59,n=62,h=16,r=24,l=40,f=51,d=67,c={images:[{id:"player1",src:"./images/julhilde.png",subids:[{id:"player1.down",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:0,yoffset:0},{duration:150,xoffset:0,yoffset:32},{duration:150,xoffset:0,yoffset:64},{duration:150,xoffset:0,yoffset:96}]},{id:"player1.left",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:e,yoffset:0},{duration:150,xoffset:e,yoffset:32},{duration:150,xoffset:e,yoffset:64},{duration:150,xoffset:e,yoffset:96}]},{id:"player1.up",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:50,yoffset:0},{duration:150,xoffset:50,yoffset:32},{duration:150,xoffset:50,yoffset:64},{duration:150,xoffset:50,yoffset:96}]},{id:"player1.right",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:70,yoffset:0},{duration:150,xoffset:70,yoffset:32},{duration:150,xoffset:70,yoffset:64},{duration:150,xoffset:70,yoffset:96}]},{id:"player1.downB",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:0,yoffset:96},{duration:150,xoffset:0,yoffset:64},{duration:150,xoffset:0,yoffset:32},{duration:150,xoffset:0,yoffset:0}]},{id:"player1.leftB",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:e,yoffset:96},{duration:150,xoffset:e,yoffset:64},{duration:150,xoffset:e,yoffset:32},{duration:150,xoffset:e,yoffset:0}]},{id:"player1.upB",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:50,yoffset:96},{duration:150,xoffset:50,yoffset:64},{duration:150,xoffset:50,yoffset:32},{duration:150,xoffset:50,yoffset:0}]},{id:"player1.rightB",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:70,yoffset:96},{duration:150,xoffset:70,yoffset:64},{duration:150,xoffset:70,yoffset:32},{duration:150,xoffset:70,yoffset:0}]},{id:"player1.crying",kind:"anim",width:e,height:i,frames:[{duration:100,xoffset:100,yoffset:0},{duration:100,xoffset:100,yoffset:i},{duration:100,xoffset:100,yoffset:64},{duration:100,xoffset:100,yoffset:96}]},{id:"player1.select",kind:"anim",width:e,height:i,frames:[{duration:130,xoffset:120,yoffset:0},{duration:130,xoffset:120,yoffset:i},{duration:130,xoffset:120,yoffset:64},{duration:130,xoffset:120,yoffset:96}]}]},{id:"player2",src:"./images/jameshilde.png",subids:[{id:"player2.down",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:0,yoffset:0},{duration:150,xoffset:0,yoffset:32},{duration:150,xoffset:0,yoffset:64},{duration:150,xoffset:0,yoffset:96}]},{id:"player2.left",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:e,yoffset:0},{duration:150,xoffset:e,yoffset:32},{duration:150,xoffset:e,yoffset:64},{duration:150,xoffset:e,yoffset:96}]},{id:"player2.up",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:50,yoffset:0},{duration:150,xoffset:50,yoffset:32},{duration:150,xoffset:50,yoffset:64},{duration:150,xoffset:50,yoffset:96}]},{id:"player2.right",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:70,yoffset:0},{duration:150,xoffset:70,yoffset:32},{duration:150,xoffset:70,yoffset:64},{duration:150,xoffset:70,yoffset:96}]},{id:"player2.downB",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:0,yoffset:96},{duration:150,xoffset:0,yoffset:64},{duration:150,xoffset:0,yoffset:32},{duration:150,xoffset:0,yoffset:0}]},{id:"player2.leftB",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:e,yoffset:96},{duration:150,xoffset:e,yoffset:64},{duration:150,xoffset:e,yoffset:32},{duration:150,xoffset:e,yoffset:0}]},{id:"player2.upB",kind:"anim",width:e,height:i,frames:[{duration:150,xoffset:50,yoffset:96},{duration:150,xoffset:50,yoffset:64},{duration:150,xoffset:50,yoffset:32},{duration:150,xoffset:50,yoffset:0}]},{id:"player2.rightB",kind:"anim",width:23,height:i,frames:[{duration:150,xoffset:70,yoffset:96},{duration:150,xoffset:70,yoffset:64},{duration:150,xoffset:70,yoffset:32},{duration:150,xoffset:70,yoffset:0}]},{id:"player2.crying",kind:"anim",width:e,height:i,frames:[{duration:100,xoffset:100,yoffset:0},{duration:100,xoffset:100,yoffset:i},{duration:100,xoffset:100,yoffset:64},{duration:100,xoffset:100,yoffset:96}]},{id:"player2.select",kind:"anim",width:e,height:i,frames:[{duration:130,xoffset:120,yoffset:0},{duration:130,xoffset:120,yoffset:i},{duration:130,xoffset:120,yoffset:64},{duration:130,xoffset:120,yoffset:96}]}]},{id:"broomEnemy",src:"./images/broom-enemy.png",subids:[{id:"broom.walkRight",kind:"anim",width:s,height:26,frames:[{duration:200,xoffset:0,yoffset:0},{duration:200,xoffset:0,yoffset:26},{duration:200,xoffset:0,yoffset:52}]},{id:"broom.walkLeft",kind:"anim",width:s,height:26,frames:[{duration:200,xoffset:0,yoffset:78},{duration:200,xoffset:0,yoffset:104},{duration:200,xoffset:0,yoffset:130}]},{id:"broom.attackRight",kind:"anim",width:28,height:26,frames:[{duration:100,xoffset:s,yoffset:0},{duration:200,xoffset:s,yoffset:26},{duration:100,xoffset:s,yoffset:52},{duration:50,xoffset:s,yoffset:78},{duration:200,xoffset:s,yoffset:104},{duration:50,xoffset:s,yoffset:130}]},{id:"broom.attackLeft",kind:"anim",width:28,height:26,frames:[{duration:100,xoffset:42,yoffset:0},{duration:200,xoffset:42,yoffset:26},{duration:100,xoffset:42,yoffset:52},{duration:50,xoffset:42,yoffset:78},{duration:200,xoffset:42,yoffset:104},{duration:50,xoffset:42,yoffset:130}]}]},{id:"shovelEnemy",src:"./images/shovel-enemy.png",subids:[{id:"shovel.idle",kind:"anim",width:h,height:r,frames:[{duration:1,xoffset:0,yoffset:0}]},{id:"shovel.bendLeft",kind:"anim",width:h,height:r,loop:!1,frames:[{duration:60,xoffset:0,yoffset:r},{duration:300,xoffset:0,yoffset:48},{duration:50,xoffset:0,yoffset:72},{duration:60,xoffset:0,yoffset:96}]},{id:"shovel.bendRight",kind:"anim",width:h,height:r,loop:!1,frames:[{duration:60,xoffset:h,yoffset:r},{duration:300,xoffset:h,yoffset:48},{duration:50,xoffset:h,yoffset:72},{duration:60,xoffset:0,yoffset:96}]},{id:"shovel.jump",kind:"anim",width:h,height:r,loop:!1,frames:[{duration:30,xoffset:0,yoffset:120},{duration:5e3,xoffset:0,yoffset:144}]},{id:"shovel.land",kind:"anim",width:h,height:r,loop:!1,frames:[{duration:100,xoffset:0,yoffset:168}]}]},{id:"bookEnemy",src:"./images/book-enemy.png",subids:[{id:"book.walkDown",kind:"anim",width:17,height:16,frames:[{duration:200,xoffset:0,yoffset:0},{duration:200,xoffset:0,yoffset:16}]},{id:"book.walkRight",kind:"anim",width:17,height:16,frames:[{duration:200,xoffset:17,yoffset:0},{duration:200,xoffset:17,yoffset:16}]},{id:"book.walkUp",kind:"anim",width:17,height:16,frames:[{duration:200,xoffset:34,yoffset:0},{duration:200,xoffset:34,yoffset:16}]},{id:"book.walkLeft",kind:"anim",width:17,height:16,frames:[{duration:200,xoffset:51,yoffset:0},{duration:200,xoffset:51,yoffset:16}]}]},{id:"deathAnim",src:"./images/deathpoof.png",subids:[{id:"poof",kind:"anim",width:23,height:32,loop:!1,frames:[{duration:100,xoffset:0,yoffset:0},{duration:60,xoffset:0,yoffset:32},{duration:60,xoffset:0,yoffset:64},{duration:100,xoffset:0,yoffset:96}]}]},{id:"title",src:"./images/title3.png",kind:"sprite"},{id:"pentagram",src:"./images/pentagram.png",kind:"sprite"},{id:"crystalball",src:"./images/crystal ball.png",kind:"sprite"},{id:"necro",src:"./images/Necronomicon.png",kind:"sprite"},{id:"cauldron2",src:"./images/cauldron.png",kind:"sprite"},{id:"potion",src:"./images/potion.png",kind:"sprite"},{id:"floorTile",src:"./images/tiles/dungeon-floor.png"},{id:"wateringCan",src:"./images/tiles/watering-can.png"},{id:"fence_b_a",src:"./images/tiles/fence_b_a.png"},{id:"fence_b_b",src:"./images/tiles/fence_b_b.png"},{id:"fence_bll",src:"./images/tiles/fence_bll.png"},{id:"fence_blu",src:"./images/tiles/fence_blu.png"},{id:"fence_brl",src:"./images/tiles/fence_brl.png"},{id:"fence_bru",src:"./images/tiles/fence_bru.png"},{id:"fence_l",src:"./images/tiles/fence_l.png"},{id:"fence_r",src:"./images/tiles/fence_r.png"},{id:"fence_t_a",src:"./images/tiles/fence_t_a.png"},{id:"fence_t_b",src:"./images/tiles/fence_t_b.png"},{id:"fence_tll",src:"./images/tiles/fence_tll.png"},{id:"fence_tlu",src:"./images/tiles/fence_tlu.png"},{id:"fence_trl",src:"./images/tiles/fence_trl.png"},{id:"fence_tru",src:"./images/tiles/fence_tru.png"},{id:"fence_gate_ll",src:"./images/tiles/fence_gate_ll.png"},{id:"fence_gate_lu",src:"./images/tiles/fence_gate_lu.png"},{id:"fence_gate_rl",src:"./images/tiles/fence_gate_rl.png"},{id:"fence_gate_ru",src:"./images/tiles/fence_gate_ru.png"},{id:"fence_gate_tl",src:"./images/tiles/fence_gate_tl.png"},{id:"fence_gate_tr",src:"./images/tiles/fence_gate_tr.png"},{id:"higrass_a",src:"./images/tiles/higrass_a.png"},{id:"higrass_b",src:"./images/tiles/higrass_b.png"},{id:"higrass_c",src:"./images/tiles/higrass_c.png"},{id:"higrass_d",src:"./images/tiles/higrass_d.png"},{id:"lograss_a",src:"./images/tiles/lograss_a.png"},{id:"lograss_b",src:"./images/tiles/lograss_b.png"},{id:"lograss_c",src:"./images/tiles/lograss_c.png"},{id:"lograss_d",src:"./images/tiles/lograss_d.png"},{id:"paver_a",src:"./images/tiles/paver_a.png"},{id:"paver_b",src:"./images/tiles/paver_b.png"},{id:"paver_c",src:"./images/tiles/paver_c.png"},{id:"paver_d",src:"./images/tiles/paver_d.png"},{id:"kitchen_art",src:"./images/tiles/kitchenart.png",subids:[{id:"kwall_l",kind:"sprite",width:16,height:16,xoffset:0,yoffset:0},{id:"kwall_tl_u",kind:"sprite",width:16,height:16,xoffset:16,yoffset:0},{id:"kwall_t",kind:"sprite",width:16,height:16,xoffset:80,yoffset:0},{id:"kwall_r_u",kind:"sprite",width:16,height:16,xoffset:0,yoffset:64},{id:"kwall_r_m",kind:"sprite",width:16,height:16,xoffset:0,yoffset:80},{id:"kwall_r_l",kind:"sprite",width:16,height:16,xoffset:0,yoffset:96},{id:"microwave",kind:"anim",width:16,height:32,frames:[{duration:500,xoffset:336,yoffset:0},{duration:500,xoffset:352,yoffset:0}]},{id:"teapot",kind:"anim",width:32,height:32,frames:[{duration:100,xoffset:368,yoffset:0},{duration:100,xoffset:400,yoffset:0},{duration:100,xoffset:432,yoffset:0},{duration:100,xoffset:464,yoffset:0}]},{id:"kwindow",kind:"sprite",width:32,height:16,xoffset:48,yoffset:0},{id:"stove",kind:"sprite",width:32,height:48,xoffset:112,yoffset:0},{id:"fridge",kind:"sprite",width:32,height:48,xoffset:176,yoffset:0},{id:"kitchen_tile",kind:"sprite",width:16,height:16,xoffset:48,yoffset:64},{id:"kitchen_tile_l",kind:"sprite",width:16,height:16,xoffset:208,yoffset:0},{id:"kitchen_tile_r",kind:"sprite",width:16,height:16,xoffset:224,yoffset:0},{id:"kitchen_tile_tl",kind:"sprite",width:16,height:16,xoffset:32,yoffset:48},{id:"kitchen_tile_t",kind:"sprite",width:16,height:16,xoffset:48,yoffset:48},{id:"beige_wall_l_u",kind:"sprite",width:16,height:16,xoffset:240,yoffset:0},{id:"beige_wall_t_u",kind:"sprite",width:16,height:16,xoffset:256,yoffset:0},{id:"beige_wall_tr_u",kind:"sprite",width:16,height:16,xoffset:288,yoffset:0},{id:"beige_wall_r",kind:"sprite",width:16,height:16,xoffset:304,yoffset:0},{id:"beige_wall_r_u",kind:"sprite",width:16,height:16,xoffset:304,yoffset:64},{id:"beige_wall_r_m",kind:"sprite",width:16,height:16,xoffset:304,yoffset:80},{id:"beige_wall_r_l",kind:"sprite",width:16,height:16,xoffset:304,yoffset:96},{id:"beige_wall_l",kind:"sprite",width:16,height:16,xoffset:0,yoffset:144},{id:"beige_wall_tl",kind:"sprite",width:16,height:16,xoffset:0,yoffset:128},{id:"beige_wall_tr",kind:"sprite",width:16,height:16,xoffset:304,yoffset:128},{id:"counter_cl",kind:"sprite",width:16,height:16,xoffset:16,yoffset:16},{id:"counter_t",kind:"sprite",width:16,height:16,xoffset:80,yoffset:16},{id:"counter_tr",kind:"sprite",width:16,height:16,xoffset:96,yoffset:16},{id:"counter_tl",kind:"sprite",width:16,height:16,xoffset:144,yoffset:16},{id:"counter_l",kind:"sprite",width:16,height:16,xoffset:16,yoffset:32},{id:"counter_lb",kind:"sprite",width:16,height:16,xoffset:16,yoffset:80},{id:"sink",kind:"sprite",width:32,height:16,xoffset:48,yoffset:16},{id:"chair_l",kind:"sprite",width:16,height:32,xoffset:240,yoffset:16},{id:"chair_r",kind:"sprite",width:16,height:32,xoffset:288,yoffset:16},{id:"table",kind:"sprite",width:32,height:32,xoffset:256,yoffset:16},{id:"cab_drawer_l",kind:"sprite",width:16,height:16,xoffset:32,yoffset:32},{id:"cab_drawer",kind:"sprite",width:16,height:16,xoffset:144,yoffset:32},{id:"cab_door_l",kind:"sprite",width:16,height:16,xoffset:48,yoffset:32},{id:"cab_door_r",kind:"sprite",width:16,height:16,xoffset:64,yoffset:32},{id:"cab_panel",kind:"sprite",width:16,height:16,xoffset:160,yoffset:32},{id:"cauldron",kind:"sprite",width:16,height:32,xoffset:336,yoffset:32}]},{id:"fridge-boss-anim",src:"./images/fridge-boss-anim.png",subids:[{id:"fridge.sleep",kind:"anim",width:32,height:48,frames:[{duration:1e4,xoffset:0,yoffset:0},{duration:80,xoffset:32,yoffset:0},{duration:80,xoffset:64,yoffset:0},{duration:80,xoffset:32,yoffset:0}]},{id:"fridge.wake",kind:"anim",width:32,height:48,frames:[{duration:120,xoffset:32,yoffset:0},{duration:120,xoffset:64,yoffset:0},{duration:120,xoffset:96,yoffset:0},{duration:120,xoffset:128,yoffset:0},{duration:120,xoffset:160,yoffset:0},{duration:120,xoffset:192,yoffset:0},{duration:120,xoffset:224,yoffset:0},{duration:120,xoffset:256,yoffset:0},{duration:120,xoffset:288,yoffset:0},{duration:120,xoffset:320,yoffset:0},{duration:120,xoffset:352,yoffset:0}]},{id:"fridge.idlel",kind:"anim",width:32,height:48,frames:[{duration:1,xoffset:416,yoffset:0}]},{id:"fridge.shootl",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:448,yoffset:0},{duration:80,xoffset:480,yoffset:0},{duration:80,xoffset:448,yoffset:0}]},{id:"fridge.idlem",kind:"anim",width:32,height:48,frames:[{duration:1,xoffset:512,yoffset:0}]},{id:"fridge.shootm",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:544,yoffset:0},{duration:80,xoffset:576,yoffset:0},{duration:80,xoffset:544,yoffset:0}]},{id:"fridge.idler",kind:"anim",width:32,height:48,frames:[{duration:1,xoffset:640,yoffset:0}]},{id:"fridge.shootr",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:672,yoffset:0},{duration:80,xoffset:704,yoffset:0},{duration:80,xoffset:672,yoffset:0}]},{id:"fridge.aim.ltr",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:384,yoffset:0},{duration:80,xoffset:512,yoffset:0},{duration:80,xoffset:608,yoffset:0},{duration:80,xoffset:640,yoffset:0}]},{id:"fridge.aim.rtl",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:608,yoffset:0},{duration:80,xoffset:512,yoffset:0},{duration:80,xoffset:384,yoffset:0},{duration:80,xoffset:416,yoffset:0}]},{id:"fridge.aim.ltm",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:384,yoffset:0},{duration:80,xoffset:512,yoffset:0}]},{id:"fridge.aim.rtm",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:608,yoffset:0},{duration:80,xoffset:512,yoffset:0}]},{id:"fridge.aim.mtl",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:384,yoffset:0},{duration:80,xoffset:416,yoffset:0}]},{id:"fridge.aim.mtr",kind:"anim",width:32,height:48,frames:[{duration:80,xoffset:608,yoffset:0},{duration:80,xoffset:640,yoffset:0}]}]},{id:"lawnmower",src:"./images/lawnmower.png",subids:[{id:"lawnmower.down",kind:"anim",width:o,height:n,frames:[{duration:1,xoffset:0,yoffset:0}]},{id:"lawnmower.left",kind:"anim",width:a,height:n,frames:[{duration:1,xoffset:o,yoffset:0}]},{id:"lawnmower.up",kind:"anim",width:37,height:n,frames:[{duration:1,xoffset:98,yoffset:0}]},{id:"lawnmower.right",kind:"anim",width:a,height:n,frames:[{duration:1,xoffset:135,yoffset:0}]},{id:"lawnmowerAccel.down",kind:"anim",width:o,height:n,loop:!0,frames:[{duration:30,xoffset:0,yoffset:124},{duration:30,xoffset:0,yoffset:186},{duration:30,xoffset:0,yoffset:248}]},{id:"lawnmowerAccel.left",kind:"anim",width:a,height:n,loop:!0,frames:[{duration:30,xoffset:o,yoffset:124},{duration:30,xoffset:o,yoffset:186},{duration:30,xoffset:o,yoffset:248}]},{id:"lawnmowerAccel.up",kind:"anim",width:37,height:n,loop:!0,frames:[{duration:30,xoffset:98,yoffset:124},{duration:30,xoffset:98,yoffset:186},{duration:30,xoffset:98,yoffset:248}]},{id:"lawnmowerAccel.right",kind:"anim",width:a,height:n,loop:!0,frames:[{duration:30,xoffset:135,yoffset:124},{duration:30,xoffset:135,yoffset:186},{duration:30,xoffset:135,yoffset:248}]},{id:"lawnmowerFlames.down",kind:"anim",width:o,height:n,loop:!1,frames:[{duration:30,xoffset:0,yoffset:310},{duration:30,xoffset:0,yoffset:372},{duration:30,xoffset:0,yoffset:434},{duration:60,xoffset:0,yoffset:496},{duration:100,xoffset:0,yoffset:558},{duration:60,xoffset:0,yoffset:620},{duration:100,xoffset:0,yoffset:682},{duration:100,xoffset:0,yoffset:744}]},{id:"lawnmowerFlames.left",kind:"anim",width:a,height:n,loop:!1,frames:[{duration:30,xoffset:o,yoffset:310},{duration:30,xoffset:o,yoffset:372},{duration:30,xoffset:o,yoffset:434},{duration:60,xoffset:o,yoffset:496},{duration:100,xoffset:o,yoffset:558},{duration:60,xoffset:o,yoffset:620},{duration:100,xoffset:o,yoffset:682},{duration:100,xoffset:o,yoffset:744}]},{id:"lawnmowerFlames.up",kind:"anim",width:37,height:n,loop:!1,frames:[{duration:30,xoffset:98,yoffset:310},{duration:30,xoffset:98,yoffset:372},{duration:30,xoffset:98,yoffset:434},{duration:60,xoffset:98,yoffset:496},{duration:100,xoffset:98,yoffset:558},{duration:60,xoffset:98,yoffset:620},{duration:100,xoffset:98,yoffset:682},{duration:100,xoffset:98,yoffset:744}]},{id:"lawnmowerFlames.right",kind:"anim",width:a,height:n,loop:!1,frames:[{duration:30,xoffset:135,yoffset:310},{duration:30,xoffset:135,yoffset:372},{duration:30,xoffset:135,yoffset:434},{duration:60,xoffset:135,yoffset:496},{duration:100,xoffset:135,yoffset:558},{duration:60,xoffset:135,yoffset:620},{duration:100,xoffset:135,yoffset:682},{duration:100,xoffset:135,yoffset:744}]}]},{id:"tv",src:"./images/tv-boss.png",subids:[{id:"tv.idle",kind:"anim",width:64,height:l,loop:!0,frames:[{duration:100,xoffset:0,yoffset:0},{duration:100,xoffset:64,yoffset:0},{duration:100,xoffset:128,yoffset:0},{duration:100,xoffset:192,yoffset:0},{duration:100,xoffset:128,yoffset:0},{duration:100,xoffset:64,yoffset:0},{duration:100,xoffset:0,yoffset:0}]},{id:"tv.att",kind:"anim",width:64,height:l,loop:!0,frames:[{duration:50,xoffset:0,yoffset:l},{duration:50,xoffset:64,yoffset:l},{duration:50,xoffset:128,yoffset:l},{duration:50,xoffset:192,yoffset:l},{duration:50,xoffset:128,yoffset:l},{duration:50,xoffset:64,yoffset:l},{duration:50,xoffset:0,yoffset:l}]}]},{id:"washer",src:"./images/washingmachine.png",subids:[{id:"washer.idle",kind:"anim",width:f,height:d,frames:[{duration:1,xoffset:0,yoffset:0}]},{id:"washer.preJump",kind:"anim",width:f,height:d,loop:!1,frames:[{duration:60,xoffset:0,yoffset:d},{duration:200,xoffset:0,yoffset:134},{duration:60,xoffset:0,yoffset:201},{duration:100,xoffset:0,yoffset:268}]},{id:"washer.jump",kind:"anim",width:f,height:d,loop:!1,frames:[{duration:80,xoffset:0,yoffset:335},{duration:100,xoffset:0,yoffset:402},{duration:100,xoffset:0,yoffset:469}]},{id:"washer.stomp",kind:"anim",width:f,height:d,loop:!1,frames:[{duration:90,xoffset:0,yoffset:536},{duration:160,xoffset:0,yoffset:603},{duration:40,xoffset:0,yoffset:670}]},{id:"washer.open",kind:"anim",width:69,height:d,loop:!1,frames:[{duration:60,xoffset:f,yoffset:d},{duration:200,xoffset:f,yoffset:134},{duration:40,xoffset:f,yoffset:201},{duration:60,xoffset:f,yoffset:268},{duration:100,xoffset:f,yoffset:335}]},{id:"washer.close",kind:"anim",width:69,height:d,loop:!1,frames:[{duration:60,xoffset:f,yoffset:335},{duration:100,xoffset:f,yoffset:402}]}]},{id:"health",src:"./images/health.png",subids:[{id:"health.dflt",kind:"anim",width:12,height:16,frames:[{duration:1,xoffset:0,yoffset:0}]}]},{id:"pickUpsSheet",src:"./images/pickups.png",subids:[{id:"spreadGun",kind:"anim",width:12,height:12,frames:[{duration:1,xoffset:0,yoffset:0}]},{id:"laserGun",kind:"anim",width:12,height:12,frames:[{duration:1,xoffset:12,yoffset:0}]}]},{id:"projectilesSheet",src:"./images/projectiles.png",subids:[{id:"bulletR",kind:"anim",width:19,height:9,frames:[{duration:1,xoffset:0,yoffset:0}]},{id:"bulletL",kind:"anim",width:19,height:9,frames:[{duration:1,xoffset:0,yoffset:9}]},{id:"bulletD",kind:"anim",width:9,height:19,frames:[{duration:1,xoffset:5,yoffset:18}]},{id:"bulletU",kind:"anim",width:9,height:19,frames:[{duration:1,xoffset:5,yoffset:37}]},{id:"spread",kind:"anim",width:14,height:12,frames:[{duration:1,xoffset:44,yoffset:0}]},{id:"laserR",kind:"anim",width:25,height:10,frames:[{duration:1,xoffset:19,yoffset:0}]},{id:"laserL",kind:"anim",width:25,height:10,frames:[{duration:1,xoffset:19,yoffset:10}]},{id:"laserD",kind:"anim",width:10,height:25,frames:[{duration:1,xoffset:26,yoffset:20}]},{id:"laserU",kind:"anim",width:10,height:25,frames:[{duration:1,xoffset:26,yoffset:45}]}]},{id:"icecube",src:"./images/icecube.png",subids:[{id:"icecube.dflt",kind:"anim",width:4,height:4,frames:[{duration:50,xoffset:0,yoffset:0},{duration:50,xoffset:4,yoffset:0},{duration:50,xoffset:8,yoffset:0},{duration:50,xoffset:12,yoffset:0}]}]},{id:"lrart",src:"./images/tiles/lrart.png",subids:[{id:"lr_carpet",kind:"sprite",width:16,height:16,xoffset:32,yoffset:48},{id:"lr_carpet_tl",kind:"sprite",width:16,height:16,xoffset:16,yoffset:32},{id:"lr_carpet_t",kind:"sprite",width:16,height:16,xoffset:32,yoffset:32},{id:"lr_carpet_tr",kind:"sprite",width:16,height:16,xoffset:288,yoffset:32},{id:"lr_carpet_l",kind:"sprite",width:16,height:16,xoffset:16,yoffset:48},{id:"lr_carpet_r",kind:"sprite",width:16,height:16,xoffset:288,yoffset:48},{id:"lr_wall_t",kind:"sprite",width:16,height:32,xoffset:32,yoffset:0},{id:"lr_wall_tl",kind:"sprite",width:16,height:32,xoffset:16,yoffset:0},{id:"lr_wall_l",kind:"sprite",width:16,height:16,xoffset:0,yoffset:0},{id:"lr_wall_tr",kind:"sprite",width:16,height:32,xoffset:288,yoffset:0},{id:"lr_wall_r",kind:"sprite",width:16,height:16,xoffset:304,yoffset:0},{id:"lr_wall_tlc",kind:"sprite",width:16,height:48,xoffset:0,yoffset:64},{id:"lr_wall_blc",kind:"sprite",width:16,height:16,xoffset:0,yoffset:128},{id:"lr_wall_trc",kind:"sprite",width:16,height:48,xoffset:304,yoffset:64},{id:"lr_wall_brc",kind:"sprite",width:16,height:16,xoffset:304,yoffset:128},{id:"lr_landing",kind:"sprite",width:32,height:16,xoffset:96,yoffset:32},{id:"lr_door",kind:"sprite",width:32,height:32,xoffset:96,yoffset:0},{id:"lr_window",kind:"sprite",width:32,height:32,xoffset:144,yoffset:0},{id:"lr_chair",kind:"sprite",width:32,height:32,xoffset:352,yoffset:32},{id:"side_table",kind:"sprite",width:16,height:32,xoffset:384,yoffset:32},{id:"plant",kind:"sprite",width:16,height:32,xoffset:400,yoffset:32},{id:"bookcase",kind:"sprite",width:32,height:48,xoffset:320,yoffset:64},{id:"bookcase_l",kind:"sprite",width:16,height:64,xoffset:352,yoffset:64},{id:"bookcase_r",kind:"sprite",width:16,height:64,xoffset:368,yoffset:64},{id:"coatrack",kind:"sprite",width:32,height:48,xoffset:416,yoffset:32},{id:"lamp",kind:"anim",width:32,height:48,frames:[{duration:3e3,xoffset:448,yoffset:0},{duration:3e3,xoffset:480,yoffset:0}]},{id:"tv",kind:"anim",width:32,height:32,frames:[{duration:500,xoffset:320,yoffset:0},{duration:500,xoffset:352,yoffset:0},{duration:500,xoffset:384,yoffset:0},{duration:500,xoffset:416,yoffset:0}]}]},{id:"laundry_art",src:"./images/tiles/laundry_art.png",subids:[{id:"laundry_wall_l",kind:"sprite",width:16,height:16,xoffset:0,yoffset:0},{id:"laundry_wall_bl",kind:"sprite",width:16,height:48,xoffset:0,yoffset:64},{id:"laundry_wall_tl",kind:"sprite",width:16,height:48,xoffset:0,yoffset:128},{id:"laundry_wall_t",kind:"sprite",width:16,height:16,xoffset:32,yoffset:0},{id:"laundry_wall_ttl",kind:"sprite",width:16,height:16,xoffset:16,yoffset:0},{id:"laundry_wall_ltt",kind:"sprite",width:16,height:16,xoffset:96,yoffset:0},{id:"laundry_wall_ttr",kind:"sprite",width:16,height:16,xoffset:144,yoffset:0},{id:"laundry_wall_rtt",kind:"sprite",width:16,height:16,xoffset:288,yoffset:0},{id:"laundry_wall_r",kind:"sprite",width:16,height:16,xoffset:304,yoffset:0},{id:"laundry_bwall_ttr",kind:"sprite",width:16,height:48,xoffset:304,yoffset:64},{id:"laundry_bwall_rtb",kind:"sprite",width:16,height:16,xoffset:304,yoffset:128},{id:"laundry_twall_t",kind:"sprite",width:16,height:16,xoffset:192,yoffset:16},{id:"laundry_twall_rtt",kind:"sprite",width:16,height:16,xoffset:288,yoffset:16},{id:"laundry_tile_a",kind:"sprite",width:16,height:16,xoffset:64,yoffset:80},{id:"laundry_tile_a_t",kind:"sprite",width:16,height:16,xoffset:0,yoffset:112},{id:"laundry_tile_a_r",kind:"sprite",width:16,height:16,xoffset:128,yoffset:16},{id:"laundry_tile_a_l",kind:"sprite",width:16,height:16,xoffset:32,yoffset:80},{id:"laundry_tile_a_ttl",kind:"sprite",width:16,height:16,xoffset:32,yoffset:48},{id:"laundry_tile_b",kind:"sprite",width:16,height:16,xoffset:64,yoffset:64},{id:"laundry_tile_b_t",kind:"sprite",width:16,height:16,xoffset:16,yoffset:112},{id:"laundry_tile_b_l",kind:"sprite",width:16,height:16,xoffset:32,yoffset:64},{id:"laundry_tile_b_r",kind:"sprite",width:16,height:16,xoffset:128,yoffset:0},{id:"laundry_tile_b_rtt",kind:"sprite",width:16,height:16,xoffset:288,yoffset:32},{id:"laundry_tile_c",kind:"sprite",width:16,height:16,xoffset:48,yoffset:64},{id:"laundry_tile_c_t",kind:"sprite",width:16,height:16,xoffset:208,yoffset:32},{id:"laundry_tile_c_l",kind:"sprite",width:16,height:16,xoffset:112,yoffset:0},{id:"laundry_ctr_ttl",kind:"sprite",width:16,height:16,xoffset:16,yoffset:16},{id:"laundry_ctr_l",kind:"sprite",width:16,height:16,xoffset:16,yoffset:32},{id:"laundry_ctr_ltt",kind:"sprite",width:16,height:16,xoffset:16,yoffset:80},{id:"laundry_ctr_t",kind:"sprite",width:16,height:16,xoffset:32,yoffset:16},{id:"laundry_ctr_rtt",kind:"sprite",width:16,height:16,xoffset:96,yoffset:16},{id:"laundry_ctr_ttr",kind:"sprite",width:16,height:16,xoffset:144,yoffset:16},{id:"laundry_cab_lside",kind:"sprite",width:16,height:16,xoffset:16,yoffset:96},{id:"laundry_cab_ldoor",kind:"sprite",width:16,height:16,xoffset:32,yoffset:32},{id:"laundry_cab_rdoor",kind:"sprite",width:16,height:16,xoffset:96,yoffset:32},{id:"laundry_cab_shelf",kind:"sprite",width:32,height:16,xoffset:48,yoffset:32},{id:"laundry_cab_open",kind:"sprite",width:32,height:16,xoffset:400,yoffset:0},{id:"wash_dryer",kind:"sprite",width:48,height:48,xoffset:320,yoffset:0},{id:"laundry_sink",kind:"sprite",width:32,height:32,xoffset:368,yoffset:0},{id:"laundry_rack",kind:"sprite",width:32,height:48,xoffset:432,yoffset:0},{id:"laundry_basket",kind:"sprite",width:16,height:32,xoffset:464,yoffset:0},{id:"mop",kind:"sprite",width:16,height:48,xoffset:480,yoffset:0},{id:"potion_purple_o",kind:"sprite",width:16,height:32,xoffset:320,yoffset:48},{id:"potion_green_o",kind:"sprite",width:16,height:16,xoffset:336,yoffset:48},{id:"potion_blue_o",kind:"sprite",width:16,height:16,xoffset:336,yoffset:64},{id:"potion_red_o",kind:"sprite",width:16,height:32,xoffset:352,yoffset:48},{id:"potion_black_o",kind:"sprite",width:16,height:32,xoffset:368,yoffset:48},{id:"potion_yellow_o",kind:"sprite",width:16,height:32,xoffset:384,yoffset:48},{id:"potion_cluster_a",kind:"sprite",width:16,height:32,xoffset:320,yoffset:80},{id:"potion_cluster_b",kind:"sprite",width:16,height:32,xoffset:336,yoffset:80}]}],sounds:[{id:"shoot",src:"./sounds/shoot"}]},y="probably"==(new Audio).canPlayType("audio/mp3")?"mp3":"ogg";class u{constructor(t,e){this.filePath=t,this.soundIndex=0,this.sounds=[this.getAudio(),this.getAudio()],this.sounds[this.soundIndex].addEventListener("canplay",e)}getAudio(t){return new Audio(`${this.filePath}.${y}`)}play(){this.sounds[this.soundIndex].paused||this.sounds.splice(this.soundIndex,0,this.getAudio()),this.sounds[this.soundIndex].currentTime=0,this.sounds[this.soundIndex].play(),this.soundIndex=++this.soundIndex%this.sounds.length}}const p=new class{constructor(){this.assets={images:{},sounds:{}},this.assetDefs=[];for(const[t,e]of Object.entries(c))for(const i of e)i.type=t,this.assetDefs.push(i)}loadAssets(){return Promise.all(this.assetDefs.map((t=>new Promise(((e,i)=>{if("images"==t.type){const s=new Image;s.onload=()=>e({id:t.id,subids:t.subids||[],asset:s,type:t.type}),s.onerror=()=>i(s),s.src=t.src}else if("sounds"==t.type){const i=new u(t.src,(()=>e({id:t.id,asset:i,type:t.type})))}}))))).then((t=>{t.forEach((t=>{if("images"===t.type){const e={img:t.asset,kind:"sprite",id:t.id};this.assets[t.type][t.id]=e;for(const e of t.subids){const i=Object.assign({},e);i.img=t.asset,this.assets[t.type][i.id]=i}}else this.assets[t.type][t.id]=t.asset})),Object.freeze(this.assets)}))}getImage(t){return this.assets.images[t]}getSound(t){return this.assets.sounds[t]}},x=.2;class m{constructor(){this.player=null,this.reset()}update(t){this.previousState=Object.assign({},this.currentState)}reset(){this.currentState={};for(const t of k)this.currentState[t]=!1;this.previousState=Object.assign({},this.currentState)}}const g=["F12"];class w extends m{constructor(){super(),this.name="Keyboard & Mouse",this.cntrls1="Move: WASD or Arrows",this.cntrls2="Shoot: Mouse",this.cntrls3="Dash: Spacebar",this.mouseButtonHeld=!1,this.mousePos={x:null,y:null},document.addEventListener("keydown",(t=>{t.defaultPrevented||(g.includes(t.code)||t.preventDefault(),this.flipState(t.code,!0))})),document.addEventListener("keyup",(t=>{t.defaultPrevented||(t.preventDefault(),this.flipState(t.code,!1))})),t.canvas.addEventListener("mousemove",(t=>{this.updateMousePos(t)})),t.canvas.addEventListener("mousedown",(t=>{this.mouseButtonHeld=!0})),t.canvas.addEventListener("mouseup",(t=>{this.mouseButtonHeld=!1}))}updateMousePos(t){const e=t.target.getBoundingClientRect(),i=t.target.width/e.width,s=t.target.height/e.height,o=document.documentElement;this.mousePos.x=i*(t.clientX-e.left-o.scrollLeft),this.mousePos.y=s*(t.clientY-e.top-o.scrollTop)}flipState(t,e){switch(t){case"ArrowUp":case"KeyW":this.currentState.up=e;break;case"ArrowDown":case"KeyS":this.currentState.down=e;break;case"ArrowLeft":case"KeyA":this.currentState.left=e;break;case"ArrowRight":case"KeyD":this.currentState.right=e;break;case"KeyC":this.currentState.credits=e;break;case"KeyP":this.currentState.pause=e;break;case"KeyM":this.currentState.mute=e;break;case"Enter":this.currentState.start=e;break;case"Space":this.currentState.dash=e}}update(t){super.update(t),this.mouseButtonHeld?null!=this.player&&(Math.round(this.player.x+this.player.width/2),Math.round(this.player.y+this.player.height/2),this.currentState.shootLeft=this.mousePos.x<this.player.pos.x-1,this.currentState.shootRight=this.mousePos.x>this.player.pos.x+this.player.width+1,this.currentState.shootUp=this.mousePos.y<this.player.pos.y-1,this.currentState.shootDown=this.mousePos.y>this.player.pos.y+this.player.height+1):(this.currentState.shootLeft=!1,this.currentState.shootRight=!1,this.currentState.shootUp=!1,this.currentState.shootDown=!1)}}class _ extends m{constructor(t){super(),this.gamepad=t,this.name="Gamepad "+t.index,this.pressedButtons=new Set,this.heldButtons=new Set,this.releasedButtons=new Set}update(t){const e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];for(const t of e)if(t.index===this.gamepad.index){this.gamepad=t;break}super.update(t),this.pressedButtons.clear(),this.releasedButtons.clear(),this.gamepad.buttons.forEach(((t,e)=>{1==t||"object"==typeof t&&t.pressed?(this.heldButtons.has(e)||this.pressedButtons.add(e),this.heldButtons.add(e)):(this.heldButtons.has(e)&&this.releasedButtons.add(e),this.heldButtons.delete(e))})),this.gamepad.axes.length>=2&&(this.currentState.left=this.gamepad.axes[0]<-.2||this.heldButtons.has(14),this.currentState.right=this.gamepad.axes[0]>x||this.heldButtons.has(15),this.currentState.up=this.gamepad.axes[1]<-.2||this.heldButtons.has(12),this.currentState.down=this.gamepad.axes[1]>x||this.heldButtons.has(13)),this.gamepad.axes.length>=4&&(this.currentState.shootLeft=this.gamepad.axes[2]<-.2||this.heldButtons.has(2),this.currentState.shootRight=this.gamepad.axes[2]>x||this.heldButtons.has(1),this.currentState.shootUp=this.gamepad.axes[3]<-.2||this.heldButtons.has(3),this.currentState.shootDown=this.gamepad.axes[3]>x||this.heldButtons.has(0)),this.currentState.start=this.pressedButtons.has(9),this.currentState.dash=this.heldButtons.has(4)}}const k=["start","pause","mute","credits","debug","left","right","up","down","left","right","shootUp","shootDown","shootLeft","shootRight","dash","gamepadConnected","gamepadDisconnected","warpToLevel1","warpToLevel2","warpToLevel3","warpToLevel4","warpToLevel5","warpToLevel6","warpToLevel7","warpToLevel8","warpToLevel9"],v=new class{constructor(){this.listeners={};for(const t of k)this.listeners[t]=[];this.controls={},this.defaultControl=null,this.primaryControl=null}initialize(){this.controls.keyboardAndMouse=new w,this.defaultControl=this.controls.keyboardAndMouse,window.addEventListener("gamepadconnected",(t=>{const e="gamepad"+t.gamepad.index;if(void 0===this.controls[e]){this.controls[e]=new _(t.gamepad);for(const t of this.listeners.gamepadConnected)t(this.controls[e])}})),window.addEventListener("gamepaddisconnected",(t=>{const e="gamepad"+t.gamepad.index;if(void 0!==this.controls[e]){this.controls[e]=new _(t.gamepad);for(const t of this.listeners.gamepadDisconnected)t(this.controls[e]);delete this.controls[e]}}))}reset(){for(const t in this.listeners)this.listeners[t]=[];this.on(["start","gamepadConnected"],(t=>{null===this.primaryControl&&(this.primaryControl=t)}));for(const t of Object.values(this.controls))t.reset();this.on("mute",(t=>{window.mute=!window.mute})),this.on("pause",(t=>{window.pauseGame()}))}on(t,e){("string"==typeof t||t instanceof String)&&(t=[t]);for(const i of t)this.listeners[i].push(e)}update(t){for(const e of Object.values(this.controls)){for(const[t,i]of Object.entries(e.currentState))if(i&&!e.previousState[t]){const i=this.listeners[t]||[];for(const t of i)t(e)}e.update(t)}}},b=function(t,e,i){return t.hasOwnProperty(e)?t[e]:i};class A{constructor(t){this.id=t.id,this.img=t.img,this.frames=t.frames,this.xOffset=t.xOffset,this.yOffset=t.yOffset,this.width=t.width,this.height=t.height,this.x=b(t,"x",0),this.y=b(t,"y",0),this.loop=b(t,"loop",!0),this.reset(),this.playing=b(t,"play",!1)}reset(){this.timer=0,this.playing=!1,this.currentFrameIndex=0}draw(t,e=0,i=0){if(this.frames.length){const s=this.frames[this.currentFrameIndex];t.drawImage(this.img,s.xoffset,s.yoffset,this.width,this.height,this.x+e,this.y+i,this.width,this.height)}else t.fillStyle="red",t.fillRect(this.x,this.y,this.width,this.height)}play(){this.playing=!0}stop(){this.playing=!1}update(t){if(!this.playing||void 0===this.frames||!this.frames.length)return;const e=this.frames[this.currentFrameIndex].duration/1e3;this.timer+=t,this.timer>=e&&(this.timer=0,this.currentFrameIndex>=this.frames.length-1?(this.currentFrameIndex=0,this.loop||this.stop()):this.currentFrameIndex++)}}class T{constructor(t,e){this._views=[],this.properties=Object.assign({},t.properties);for(let i=0;i<t.height;i++)for(let s=0;s<t.width;s++){const o=e.getImage(t.get(s,i)),a=16*s,n=16*i;if(o){o.play=!0,o.x=a,o.y=n;const t=M(o);t&&this._views.push(t)}}}update(t){for(const e of this._views)e.update&&e.update(t)}draw(t){for(const e of this._views)e.draw(t)}}class I{constructor(t){this._id=t.id,this._img=t.img,this._x=t.x||0,this._y=t.y||0,this._xoffset=t.xoffset||0,this._yoffset=t.yoffset||0,this._width=t.width||this.img.width,this._height=t.height||this.img.height}get img(){return this._img||{width:0,height:0}}get width(){return this.img.width}get height(){return this.img.height}draw(t,e=0,i=0){this._img&&t.drawImage(this._img,this._xoffset,this._yoffset,this._width,this._height,this._x+e,this._y+i,this._width,this._height)}toString(){return"[Sprite:"+this._id+"]"}}function M(t){if(t)return"anim"===t.kind?new A(t):new I(t)}const S=new class{constructor(){this.liveEntities=new Set,this.deadEntities=new Set,this.collisionListeners={}}add(t){this.liveEntities.add(t)}kill(t){this.deadEntities.add(t),this.liveEntities.delete(t)}onCollision(t,e,i){void 0===this.collisionListeners[t+e]?this.collisionListeners[t+e]=[i]:this.collisionListeners[t+e].push(i)}update(t){for(const e of this.liveEntities)e.update(t);for(const t of this.liveEntities)for(const e of this.liveEntities)if(t!==e&&t.canCollideWithTypes.has(e.type)&&t.collider.x<e.collider.x+e.collider.width&&t.collider.x+t.collider.width>e.collider.x&&t.collider.y<e.collider.y+e.collider.height&&t.collider.y+t.collider.height>e.collider.y){const i=this.collisionListeners[t.type+e.type];if(void 0!==i)for(const s of i)t.alive&&e.alive&&s(t,e)}}spawn(t,...e){const i=[...this.deadEntities].filter((e=>e instanceof t));let s;return i.length?(s=i[0],this.deadEntities.delete(s),s.reset(...e)):s=new t(...e),s.alive=!0,this.add(s),s}draw(){for(const t of[...this.liveEntities].reverse())t.draw()}getLiveForType(t){return[...this.liveEntities].filter((e=>e.type==t))}reset(){for(const t of this.liveEntities)t.die()}};class L{constructor(t,e,i,s,o,a=10,n=1,h={},r=""){this.pos=Object.assign({},e),this.prevPos=Object.assign({},this.pos),this.width=i,this.height=s,this.type=t,this.collider=Object.assign({x:0,y:0,offsetX:0,offsetY:0},o),this.canCollideWithTypes=new Set,this.hp=a,this.maxHp=a,this.damage=n,this.alive=!1,this.animations=h,this.currentAnimation=this.animations[r]||null,this.currentAnimation&&this.currentAnimation.play()}die(){this.alive=!1,S.kill(this)}hurt(t){this.hp-=t,this.hp<=0&&this.die()}heal(t){this.hp+=t,this.hp>this.maxHp&&(this.hp=this.maxHp)}reset(t,e){this.pos.x=t,this.pos.y=e,this.hp=this.maxHp}onTopWallCollision(t){}onLeftWallCollision(t){}onBottomWallCollision(t){}onRightWallCollision(t){}performActions(t){}update(e){Object.assign(this.prevPos,this.pos),this.performActions(e),this.pos.x<0&&(this.pos.x=0,this.onLeftWallCollision(e)),this.pos.y<0&&(this.pos.y=0,this.onTopWallCollision(e)),this.pos.x>t.canvas.width-this.width&&(this.pos.x=t.canvas.width-this.width,this.onRightWallCollision(e)),this.pos.y>t.canvas.height-this.height&&(this.pos.y=t.canvas.height-this.height,this.onBottomWallCollision(e)),this.collider.x=this.pos.x+(this.width-this.collider.width)/2+this.collider.offsetX,this.collider.y=this.pos.y+(this.height-this.collider.height)/2+this.collider.offsetY}draw(){this.currentAnimation&&this.currentAnimation.draw(t.context,this.pos.x,this.pos.y),window.debugMode&&(this.collider.width>0||this.collider.height>0)&&(t.context.lineWidth=1,t.context.strokeStyle="magenta",t.context.strokeRect(this.collider.x,this.collider.y,this.collider.width,this.collider.height))}changeAnimation(t){this.currentAnimation!=t&&(this.currentAnimation.stop(),this.currentAnimation.currentFrameIndex=0,this.currentAnimation=t,this.currentAnimation.play())}}class C extends L{constructor(t){const e={poof:M(p.getImage("poof"))};super("poof",{x:t.pos.x,y:t.pos.y},0,0,{width:23,height:32},1,1,e,"poof"),this.reset(t)}reset(t){super.reset(t.pos.x,t.pos.y),this.currentAnimation.reset(),this.currentAnimation.play()}update(t){super.update(t),this.currentAnimation.update(t),this.currentAnimation.playing||this.die()}}const O={bullet:{up:"bulletU",left:"bulletL",down:"bulletD",right:"bulletR"},spread:{up:"spread",left:"spread",down:"spread",right:"spread"},laser:{up:"laserU",left:"laserL",down:"laserD",right:"laserR"}};class j extends L{constructor(t,e,i,s,o,a,n,h){super("playerProjectile",{x:t,y:e},19,9,{width:4,height:2,offsetX:5,offsetY:3},n,1),this.canCollideWithTypes.add("enemy"),this.collider.width=3,this.collider.height=3,this.reset(t,e,i,s,o,a,n,h)}generateAnimations(t){this.animations={};for(const[e,i]of Object.entries(O[t]))this.animations[e]=M(p.getImage(i))}reset(t,e,i,s,o,a,n,h){super.reset(),this.pos={x:t,y:e},this.vel={x:320*i+o,y:320*s+a},this.hp=n,this.generateAnimations(h),this.currentAnimation=this.animations.right,0==this.vel.x?this.changeAnimation(this.vel.y>0?this.animations.down:this.animations.up):this.changeAnimation(this.vel.x>0?this.animations.right:this.animations.left)}update(t){super.update(t);const e={x:this.vel.x*t,y:this.vel.y*t};Math.abs(e.x)>0&&Math.abs(e.y)>0&&(e.x*=Math.SQRT1_2,e.y*=Math.SQRT1_2),this.pos.x+=Math.round(e.x),this.pos.y+=Math.round(e.y),this.collider.x=this.pos.x-1,this.collider.y=this.pos.y-1}onTopWallCollision(t){this.die()}onLeftWallCollision(t){this.die()}onBottomWallCollision(t){this.die()}onRightWallCollision(t){this.die()}}function R(t){return{x:t.pos.x+t.width/2,y:t.pos.y+t.height/2}}const E={basic:{shotTime:1/12,ammo:1/0,bulletSprite:"bullet",soundId:"shoot",bulletSpawner:(t,e,i)=>{S.spawn(j,t.x,t.y,e.x,e.y,i.x,i.y,1,"bullet")}},spread:{shotTime:.1,ammo:50,soundId:"shoot",iconId:"spreadGun",bulletSpawner:(t,e,i)=>{const s=Math.atan2(e.x,-e.y)-Math.PI/2,o=Math.PI/16;S.spawn(j,t.x,t.y,Math.cos(s-2*o),Math.sin(s-2*o),i.x,i.y,1,"spread"),S.spawn(j,t.x,t.y,Math.cos(s-o),Math.sin(s-o),i.x,i.y,1,"spread"),S.spawn(j,t.x,t.y,Math.cos(s+o),Math.sin(s+o),i.x,i.y,1,"spread"),S.spawn(j,t.x,t.y,Math.cos(s+2*o),Math.sin(s+2*o),i.x,i.y,1,"spread")}},laser:{shotTime:1/6,ammo:100,bulletSprite:"bullet",soundId:"shoot",iconId:"laserGun",bulletSpawner:(t,e,i)=>{S.spawn(j,t.x,t.y,e.x,e.y,i.x,i.y,1/0,"laser")}}};class B extends L{constructor(t,e){super("gun",R(t),10,10,{width:10,height:10}),this.reset(t,e)}reset(t,e){const i=R(t);super.reset(i.x,i.y),this.player=t,this.shotTime=e.shotTime,this.spawnBullets=e.bulletSpawner,this.timer=e.shotTime,this.soundId=e.soundId||"shoot",this.ammo=e.ammo}shoot(t){this.timer<=0&&(this.timer=this.shotTime,this.spawnBullets({x:this.pos.x,y:this.pos.y},t,this.player.vel),window.mute||p.getSound(this.soundId).play(),this.ammo--)}update(t){this.ammo<0&&(this.die(),this.player.setBasicGun()),this.pos=R(this.player),this.timer-=t,super.update(t)}}class W extends L{constructor(t,e,i,s,o="right"){super("player",{x:e,y:i},20,32,{width:12,height:24},10,1),this.cryingAnimation=M(p.getImage(s+".crying")),this.prevCollider=Object.assign({},this.collider),this.setBasicGun(),this.initialPos={x:e,y:i},this.spriteId=s,this.reset(t,e,i,s)}setBasicGun(){this.gun=S.spawn(B,this,E.basic)}reset(t,e=0,i=0,s){super.reset(),this.spriteId=s,this.animations=[[M(p.getImage(s+".left")),M(p.getImage(s+".right")),M(p.getImage(s+".up")),M(p.getImage(s+".down"))],[M(p.getImage(s+".leftB")),M(p.getImage(s+".rightB")),M(p.getImage(s+".upB")),M(p.getImage(s+".downB"))]],this.initialPos.x=e,this.initialPos.y=i,this.currentAnimation=this.animations[0][0],this.controller=t,this.hp=10,this.shotTimer=0,this.flash=!1,this.flashTimer=0,this.invincible=!0,this.invincibleTimer=0,this.dashing=0,this.enteringStage=!0,this.crying=!1,this.cryingTimer=0,this.resetPosition(e,i)}resetPosition(t,e){this.pos={x:t,y:e},this.vel={x:0,y:0},this.aim={x:0,y:0}}get alive(){return this.lives>0}set alive(t){this.lives=t?3:0}draw(){this.invincible&&this.flash||(t.context&&this.currentAnimation.draw(t.context,this.pos.x,this.pos.y),super.draw())}move(e){if(!this.crying){if(this.enteringStage)this.pos.x<t.canvas.width/2?(this.aim.x=1,this.vel.x=110,this.enteringStage=this.pos.x<t.canvas.width/2-1.5*this.width):(this.aim.x=-1,this.vel.x=-110,this.enteringStage=this.pos.x>t.canvas.width/2+1.5*this.width);else if(this.controller){const t=this.controller.currentState;let e=P(t.up,t.down,t.left,t.right);this.dashing>-24?this.dashing--:this.dashing<=-24&&t.dash&&(this.dashing=10,this.vel.x=400*e.x,this.vel.y=400*e.y),this.dashing<=0&&(this.vel.x=110*e.x,this.vel.y=110*e.y)}Object.assign(this.prevCollider,this.collider),this.pos.x+=Math.round(this.vel.x*e),this.pos.y+=Math.round(this.vel.y*e)}}onTopWallCollision(t){super.onTopWallCollision(t),this.vel.y=0}onLeftWallCollision(t){super.onLeftWallCollision(t),this.vel.x=0}onBottomWallCollision(t){super.onBottomWallCollision(t),this.vel.y=0}onRightWallCollision(t){super.onRightWallCollision(t),this.vel.x=0}shoot(t){if(this.enteringStage||!this.controller||this.crying)return;const e=this.controller.currentState;this.aim=P(e.shootUp,e.shootDown,e.shootLeft,e.shootRight),(e.shootUp||e.shootDown||e.shootLeft||e.shootRight)&&this.gun.shoot(this.aim)}animate(t){if(this.crying)return void(this.currentAnimation!=this.cryingAnimation&&this.changeAnimation(this.cryingAnimation));const e=this.currentAnimation;let i=0!=this.aim.x&&0!=this.aim.y?1:0,s=i?this.aim:this.vel;if(0!=s.x){let t=s.x<0?0:1;this.currentAnimation=this.animations[i][t]}else if(0!=s.y){let t=s.y<0?0:1;this.currentAnimation=this.animations[i][t+2]}this.currentAnimation!=e&&this.currentAnimation.reset(),0!=this.vel.x||0!=this.vel.y?this.currentAnimation.play():this.currentAnimation.stop(),this.currentAnimation.update(t)}performActions(t){this.move(t),this.shoot(t),this.animate(t),this.invincible&&(this.flashTimer>=.11?(this.flash=!this.flash,this.flashTimer=0):this.flashTimer+=t,this.invincibleTimer+=t,this.invincibleTimer>=3&&(this.invincible=!1,this.invincibleTimer=0)),this.crying&&(this.cryingTimer+=t,this.cryingTimer>=2&&this.reset(this.controller,this.initialPos.x,this.initialPos.y,this.spriteId)),super.performActions(t)}update(t){this.controller&&this.controller.update(t),super.update(t)}die(){this.lives>1?(this.lives--,this.crying=!0):S.kill(this)}}function P(t,e,i,s){let o={x:0,y:0};return t&&(o.y+=-1),e&&(o.y+=1),i&&(o.x+=-1),s&&(o.x+=1),0!=o.x&&0!=o.y&&(o.x*=Math.sqrt(.8),o.y*=Math.sqrt(.8)),o}class F extends L{constructor(e,i,s,o,a){const n={x:Math.floor(Math.random()*(t.canvas.width-e)),y:Math.floor(Math.random()*(t.canvas.height-i))};super("pickup",n,e,i,Object.assign({width:e,height:i},n),1,0,s,o),this.canCollideWithTypes.add("player"),this.timeout=a,this.timer=0}apply(t){}update(t){super.update(t),this.timer+=t,this.timer>=this.timeout&&this.die()}reset(){super.reset(Math.floor(Math.random()*(t.canvas.width-this.width)),Math.floor(Math.random()*(t.canvas.height-this.height))),this.alive=!0,this.timer=0}}function D(){const t=Object.values(E).filter((t=>t.hasOwnProperty("iconId")));return t[Math.floor(Math.random()*t.length)]}const G=[class extends F{constructor(){super(12,16,{default:M(p.getImage("health.dflt"))},"default",4)}apply(t){super.apply(t),t.heal(2)}},class extends F{constructor(){const t=D();super(12,12,{default:M(p.getImage(t.iconId))},"default",5),this.spec=t}reset(){this.spec=D(),this.animations.default=M(p.getImage(this.spec.iconId)),this.currentAnimation=this.animations.default,super.reset()}apply(t){super.apply(t),t.gun=S.spawn(B,t,this.spec)}}],N=function(t,e,i){return t.hasOwnProperty(e)?t[e]:i};class U{constructor(t={}){if(this.width=N(t,"width",16),this.height=N(t,"height",16),this.properties=N(t,"properties",{}),this.dfltValue=t.dfltValue,this.entries=new Array(this.width*this.height),t.entries)for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let s=this.index(i,e);s<t.entries.length&&this.set(t.entries[s],i,e)}this._count=0}get length(){return this._count}index(t,e){if("number"==typeof t){if(t>=0&&t<this.width&&e>=0&&e<this.height)return t+this.width*e}else if("x"in t&&"y"in t&&t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height)return t.x+this.width*t.y;return-1}get(t,e,i){let s=this.index(t,e);return-1==s?null!=i?i:this.dfltValue:this.entries[s]}set(t,e,i){let s=this.index(e,i);-1!=s&&(this.entries[s]=t),this._count++}remove(t,e){let i=this.index(t,e);-1!=i&&(this.entries[i]=void 0),this._count--}*[Symbol.iterator](){for(let t=0;t<this.entries.length;t++)void 0!==this.entries[t]&&(yield this.entries[t])}walk(t){for(let e=0;e<this.entries.length;e++)void 0!==this.entries[e]&&t(this.entries[e])}toString(){return Fmt.toString("Grid",this.width,this.height)}}class J extends L{constructor(t,e,i,s,o,a,n,h){super("enemy",t,e,i,s,o,a,n,h)}die(){S.spawn(C,this),super.die()}}class H extends L{constructor(t,e,i,s){super("enemyAttack",{x:t.pos.x-e.x,y:t.pos.y-e.y},0,0,{width:i,height:s},1,1),this.offset=e,this.parent=t,this.canCollideWithTypes.add("player")}reset(t,e,i,s){super.reset(t.pos.x+e.x,t.pos.y+e.y),this.parent=t,this.offset=e,this.damage=1,this.collider.x=this.pos.x,this.collider.y=this.pos.y,this.collider.width=i,this.collider.height=s}draw(){this.alive&&window.debugMode&&(t.context.fillStyle="red",t.context.fillRect(this.pos.x,this.pos.y,this.collider.width,this.collider.height))}performActions(t){super.performActions(t),this.pos.x=this.parent.pos.x+this.offset.x,this.pos.y=this.parent.pos.y+this.offset.y}update(t){this.parent.alive?super.update(t):this.die()}}class K extends J{constructor(t,e){const i={walkRight:M(p.getImage("broom.walkRight")),walkLeft:M(p.getImage("broom.walkLeft")),attackRight:M(p.getImage("broom.attackRight")),attackLeft:M(p.getImage("broom.attackLeft"))};i.attackRight.loop=i.attackLeft.loop=!1,super({x:t,y:e},14,26,{width:14,height:14},1,1,i,"walkRight"),this.speed=50,this.canCollideWithTypes.add("playerProjectile"),this.dir={x:1,y:0},this.vel={x:0,y:0},this.attackDistance=20,this.steerTimer=.5*Math.random()+.5,this.headButt=S.spawn(H,this,0,0,20,6.5)}performActions(t){let e,i=Number.MAX_SAFE_INTEGER;this.currentAnimation.update(t);let s=null;const o={x:0,y:0};for(const t of[...S.liveEntities].filter((t=>"player"==t.type)))e=Math.hypot(t.pos.x-this.pos.x,t.pos.y-this.pos.y),e<i&&(i=e,s=t);if(this.steerTimer<=0){const t={x:0,y:0};if(null===s)this.currentAnimation.stop();else{t.x=s.pos.x-this.pos.x,t.y=s.pos.y-this.pos.y;const e=Math.hypot(t.x,t.y);t.x=this.speed*t.x/e,t.y=this.speed*t.y/e}o.x=t.x-this.vel.x,o.y=t.y-this.vel.y,this.steerTimer=.5*Math.random()+1}else this.steerTimer-=t;if(i<this.attackDistance&&!this.attacking){this.dir.x=s.pos.x-this.pos.x;const t=this.dir.x>0?this.animations.attackRight:this.animations.attackLeft;this.changeAnimation(t);let e=this.pos.x-s.pos.x,i=this.width/2+(e>0?-28:0);this.headButt.reset(this,{x:i,y:6.5},28,6.5)}this.attacking?(4==this.currentAnimation.currentFrameIndex&&(this.headButt.alive=!0),this.currentAnimation.playing||(this.headButt.alive=!1,this.dir.x>=0?this.changeAnimation(this.animations.walkRight):this.changeAnimation(this.animations.walkLeft))):(this.vel.x+=o.x,this.vel.y+=o.y,this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),0!=o.x&&(this.dir.x=o.x),0!=o.y&&(this.dir.y=o.y),this.dir.x>=0?this.changeAnimation(this.animations.walkRight):this.changeAnimation(this.animations.walkLeft)),super.performActions(t)}die(){this.headButt&&this.headButt.alive&&this.headButt.die(),super.die()}reset(t,e){super.reset(t,e),this.headButt=S.spawn(H,this,0,0,20,6.5)}get attacking(){return this.currentAnimation==this.animations.attackLeft||this.currentAnimation==this.animations.attackRight}}class V extends J{constructor(t,e,i,s,o,a,n,h,r,l,f,d,c,y){super(t,e,i,s,o,a,n,h),this.target=null,this.jumping=!1,this.attacking=!1,this.attack=null,this.jumpSpeed=r,this.jumpTimer=this.attackDelay=l,this.maxJumpDist=f,this.preJumpAnimPrefix=d,this.jumpAnimId=c,this.landAnimId=y,this.vel={x:0,y:0}}findTarget(){let t,e=null,i=Number.MAX_SAFE_INTEGER;for(const s of S.getLiveForType("player"))t=Math.hypot(s.pos.x-this.pos.x,s.pos.y-this.pos.y),t<i&&(i=t,e=s);if(t>this.maxJumpDist){const t=Math.atan2(e.pos.x,e.pos.y)+Math.random()*(Math.PI/3),i=Math.sign(e.pos.x-this.pos.x),s=Math.sign(e.pos.y-this.pos.y);this.target={x:Math.round(this.pos.x+i*Math.cos(t)*this.maxJumpDist),y:Math.round(this.pos.y+s*Math.sin(t)*this.maxJumpDist)}}else null!==e&&(this.target={x:e.pos.x+Math.floor(5*Math.random()-2),y:e.pos.y+Math.floor(5*Math.random()-2)})}getPreJumpAnim(){throw new Error("Not implemented")}update(t){if(this.currentAnimation.update(t),super.update(t),this.jumping)this.currentAnimation.id.startsWith(this.preJumpAnimPrefix)?this.currentAnimation.playing||this.changeAnimation(this.animations[this.jumpAnimId]):(this.vel.y+=300*t,this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),this.attacking=this.vel.y>0,this.jumping=!(this.attacking&&this.pos.y>this.target.y));else if(this.jumpTimer<=0){this.findTarget();const t=this.getPreJumpAnim();this.currentAnimation!=t&&this.changeAnimation(t),this.jumping=!0,this.vel.y=-this.jumpSpeed,this.vel.x=Math.sign(this.target.x-this.pos.x)*this.jumpSpeed/2,this.jumpTimer=this.attackDelay}else this.currentAnimation===this.animations[this.jumpAnimId]?this.changeAnimation(this.animations[this.landAnimId]):this.currentAnimation!==this.animations[this.landAnimId]||this.currentAnimation.playing||this.changeAnimation(this.animations.idle),this.attacking=!1,this.vel.x=0,this.vel.y=0,this.jumpTimer-=t;this.attacking?null===this.attack&&(this.attack=S.spawn(H,this,{x:0,y:this.height/2},this.width,this.height/2)):null!==this.attack&&(this.attack.die(),this.attack=null)}}class X extends V{constructor(t,e){super({x:t,y:e},16,24,{width:12,height:14},1,1,{idle:M(p.getImage("shovel.idle")),bendLeft:M(p.getImage("shovel.bendLeft")),bendRight:M(p.getImage("shovel.bendRight")),jump:M(p.getImage("shovel.jump")),land:M(p.getImage("shovel.land"))},"idle",120,.75,48,"shovel.bend","jump","land")}draw(){super.draw(),this.target&&(t.context.fillStyle="red",t.context.arc(this.target.x,this.target.y,2,0,Math.PI))}getPreJumpAnim(){return this.target.x>this.pos.x?this.animations.bendLeft:this.animations.bendRight}}class Y extends J{constructor(t,e){const i={walkUp:M(p.getImage("book.walkUp")),walkRight:M(p.getImage("book.walkRight")),walkDown:M(p.getImage("book.walkDown")),walkLeft:M(p.getImage("book.walkLeft"))};i.walkDown.loop=i.walkDown.loop=!1,super({x:t,y:e},14,26,{width:14,height:14},1,1,i,"walkRight"),this.speed=50,this.canCollideWithTypes.add("playerProjectile"),this.dir={x:1,y:0},this.vel={x:0,y:0},this.attackDistance=20,this.steerTimer=.5*Math.random()+.5,this.headButt=S.spawn(H,this,0,0,20,6.5)}performActions(t){let e,i=Number.MAX_SAFE_INTEGER;this.currentAnimation.update(t);let s=null;const o={x:0,y:0};for(const t of[...S.liveEntities].filter((t=>"player"==t.type)))e=Math.hypot(t.pos.x-this.pos.x,t.pos.y-this.pos.y),e<i&&(i=e,s=t);if(this.steerTimer<=0){const t={x:0,y:0};if(null===s)this.currentAnimation.stop();else{t.x=s.pos.x-this.pos.x,t.y=s.pos.y-this.pos.y;const e=Math.hypot(t.x,t.y);t.x=this.speed*t.x/e,t.y=this.speed*t.y/e}o.x=t.x-this.vel.x,o.y=t.y-this.vel.y,this.steerTimer=.5*Math.random()+1}else this.steerTimer-=t;this.vel.x+=o.x,this.vel.y+=o.y,this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),0!=o.x&&(this.dir.x=o.x),0!=o.y&&(this.dir.y=o.y),this.dir.x>=0?this.changeAnimation(this.animations.walkRight):this.changeAnimation(this.animations.walkLeft),super.performActions(t)}die(){this.headButt&&this.headButt.alive&&this.headButt.die(),super.die()}get attacking(){return this.currentAnimation==this.animations.attackLeft||this.currentAnimation==this.animations.attackRight}}class q extends J{}class z extends L{constructor(t,e,i,s,o,a,n){super("enemyProjectile"),this.canCollideWithTypes.add("player"),this.collider.width=3,this.collider.height=3,this.reset(t,e,i,s,o,a),this.anim=n,this.anim&&(this.anim.playing=!0)}reset(t,e,i,s,o,a){super.reset(),this.pos={x:t,y:e},this.vel={x:500*i+o,y:500*s+a}}update(e){super.update(e),this.anim&&this.anim.update(e);const i={x:this.vel.x*e,y:this.vel.y*e};Math.abs(i.x)>0&&Math.abs(i.y)>0&&(i.x*=Math.SQRT1_2,i.y*=Math.SQRT1_2),this.pos.x+=Math.round(i.x),this.pos.y+=Math.round(i.y),this.collider.x=this.pos.x-1,this.collider.y=this.pos.y-1,(this.pos.x<0||this.pos.x>t.canvas.width||this.pos.y<0||this.pos.y>t.canvas.height)&&this.die()}draw(){super.draw(),this.anim?this.anim.draw(t.context,this.pos.x-2,this.pos.y-2):(t.context.fillStyle="white",t.context.fillRect(this.pos.x-2,this.pos.y-2,4,4))}}const Q="higrass_a",$="lograss_b",Z="fence_tlu",tt="fence_bll",et="fence_blu",it="fence_tru",st="fence_brl",ot="fence_bru",at="fence_t_a",nt="fence_t_b",ht="fence_l",rt="fence_r",lt="fence_b_a",ft="fence_b_b",dt="paver_a",ct="paver_b",yt="paver_c",ut="paver_d",pt="undefined",xt="kitchen_tile",mt="kitchen_tile_l",gt="kitchen_tile_r",wt="kitchen_tile_t",_t="kwall_l",kt="kwall_t",vt="kwall_r_m",bt="beige_wall_t_u",At="beige_wall_r",Tt="beige_wall_l",It="counter_t",Mt="counter_tr",St="counter_l",Lt="cab_drawer",Ct="cab_door_l",Ot="cab_door_r",jt=16,Rt=20,Et=15,Bt=new U({width:Rt,height:Et,entries:["fence_tll",at,nt,at,at,nt,at,at,"fence_gate_tl",dt,ct,"fence_gate_tr",at,nt,at,at,nt,at,nt,"fence_trl",Q,Q,Q,Q,Q,Q,Q,Q,Q,yt,ut,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,ct,yt,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,ct,ut,dt,ct,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,dt,yt,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,$,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,ct,yt,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,ut,dt,Q,Q,Q,Q,Q,Q,Q,Q,Q]}),Wt=new U({width:Rt,height:Et});Wt.set("wateringCan",17,0);const Pt=new U({width:Rt,height:Et,properties:{fg:!0},entries:[pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,et,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,ot,"fence_gate_lu",pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,"fence_gate_ru",pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,Z,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,it,"fence_gate_ll",pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,"fence_gate_rl",ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,rt,et,pt,pt,pt,pt,pt,pt,pt,it,pt,pt,Z,pt,pt,pt,pt,pt,pt,pt,ot,tt,lt,lt,ft,lt,ft,lt,lt,st,pt,pt,tt,lt,ft,lt,lt,ft,lt,lt,st]}),Ft=new U({width:Rt,height:Et,entries:[_t,"kwall_tl_u",kt,"kwindow",pt,kt,kt,"stove",pt,kt,kt,kt,vt,mt,gt,"beige_wall_l_u",bt,bt,"beige_wall_tr_u",At,_t,"counter_cl",It,"sink",pt,It,Mt,pt,pt,"counter_tl",Mt,xt,xt,mt,gt,"chair_l","table",pt,"chair_r",At,_t,St,"cab_drawer_l",Ct,Ot,Ct,Ot,pt,pt,Lt,Lt,xt,xt,mt,xt,pt,pt,pt,pt,At,_t,St,"kitchen_tile_tl",wt,wt,wt,wt,wt,wt,wt,wt,wt,wt,xt,xt,xt,xt,xt,gt,At,"kwall_r_u",St,mt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,gt,"beige_wall_r_u",vt,"counter_lb",mt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,gt,"beige_wall_r_m","kwall_r_l","cab_panel",mt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,gt,"beige_wall_r_l",wt,wt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,wt,"beige_wall_tl",xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,"beige_wall_tr",Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At,Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At,Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At,Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At,Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At,Tt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,xt,At]}),Dt=new U({width:Rt,height:Et});Dt.set("microwave",2,0),Dt.set("fridge.sleep",11,0),Dt.set("teapot",6,0),Dt.set("cauldron",9,0),Dt.set("potion_cluster_b",5,0),Dt.set("potion_cluster_a",1,0),Dt.set("potion_black_o",1,3);const Gt=new U({width:Rt,height:Et,properties:{fg:!0},entries:[pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt]}),Nt="lr_carpet",Ut="lr_carpet_l",Jt="lr_carpet_t",Ht="lr_carpet_r",Kt="lr_wall_t",Vt="lr_wall_r",Xt="lr_wall_l",Yt="lr_window",qt="lr_chair",zt=new U({width:Rt,height:Et,entries:[Xt,"lr_wall_tl",Kt,Kt,Yt,pt,Kt,Kt,Kt,"lr_door",pt,Kt,Kt,Yt,pt,Kt,Kt,Kt,"lr_wall_tr",Vt,Xt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,Vt,Xt,"lr_carpet_tl",Jt,Jt,Jt,Jt,Jt,Jt,Jt,"lr_landing",pt,Jt,Jt,Jt,Jt,Jt,Jt,Jt,"lr_carpet_tr",Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt,"lr_wall_tlc",Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,"lr_wall_trc",pt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,pt,pt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,pt,Jt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Jt,"lr_wall_blc",Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,"lr_wall_brc",Xt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt,Xt,Ut,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Nt,Ht,Vt]}),Qt=new U({width:Rt,height:Et});Qt.set("plant",1,1),Qt.set(qt,2,1),Qt.set("side_table",4,1),Qt.set("bookcase",7,0),Qt.set("coatrack",11,0),Qt.set("tv",13,1),Qt.set(qt,15,1),Qt.set("lamp",17,0),Qt.set("bookcase_l",1,10),Qt.set("bookcase_r",18,10);const $t=new U({width:Rt,height:Et,properties:{fg:!0},entries:[pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt]}),Zt="laundry_tile_a",te="laundry_tile_a_t",ee="laundry_tile_a_r",ie="laundry_tile_b",se="laundry_tile_b_t",oe="laundry_tile_b_l",ae="laundry_tile_b_r",ne="laundry_tile_c",he="laundry_tile_c_t",re="laundry_tile_c_l",le="laundry_wall_l",fe="laundry_wall_t",de="laundry_wall_r",ce="laundry_twall_t",ye="laundry_ctr_l",ue="laundry_ctr_t",pe="laundry_ctr_rtt",xe="laundry_cab_ldoor",me=new U({width:Rt,height:Et,entries:[le,"laundry_wall_ttl",fe,fe,fe,fe,"laundry_wall_ltt",re,ae,"laundry_wall_ttr",fe,fe,fe,fe,fe,fe,fe,fe,"laundry_wall_rtt",de,le,"laundry_ctr_ttl",ue,ue,ue,ue,pe,oe,ee,"laundry_ctr_ttr",ue,pe,ce,ce,ce,ce,ce,ce,"laundry_twall_rtt",de,le,ye,xe,"laundry_cab_shelf",pt,xe,"laundry_cab_rdoor",re,ae,xe,se,he,se,he,se,he,se,he,"laundry_tile_b_rtt",de,le,ye,"laundry_tile_a_ttl",se,te,se,te,ie,Zt,se,Zt,ie,Zt,ie,Zt,ie,Zt,ie,ee,de,"laundry_wall_bl",ye,oe,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ae,"laundry_bwall_ttr",pt,"laundry_ctr_ltt","laundry_tile_a_l",ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,ee,pt,pt,"laundry_cab_lside",oe,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ae,pt,te,se,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,se,"laundry_wall_tl",ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,"laundry_bwall_rtb",le,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,de,le,re,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ae,de,le,oe,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,ee,de,le,re,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ae,de,le,oe,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,Zt,ie,ee,de,le,re,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ie,ne,ae,de]}),ge=new U({width:Rt,height:Et});ge.set("laundry_cab_open",10,2),ge.set("wash_dryer",12,0),ge.set("laundry_sink",5,0),ge.set("laundry_rack",15,0),ge.set("laundry_basket",17,1),ge.set("laundry_basket",11,0),ge.set("mop",18,0),ge.set("potion_yellow_o",9,0),ge.set("potion_cluster_a",10,0),ge.set("potion_cluster_b",1,3),ge.set("potion_yellow_o",1,2),ge.set("potion_purple_o",1,1);const we=[{name:"Level 1",loaded:!1,complete:!1,started:!1,grids:[Bt,Wt,Pt],waves:[{spawners:[{cls:K,x:162,y:1},{cls:K,x:160,y:3},{cls:K,x:161,y:5},{cls:K,x:159,y:7},{cls:K,x:158,y:9},{cls:K,x:161,y:3},{cls:K,x:160,y:5},{cls:K,x:155,y:2},{cls:K,x:163,y:4}],timeOut:12},{spawners:[{cls:K,x:302,y:101},{cls:K,x:304,y:103},{cls:K,x:305,y:105},{cls:K,x:301,y:107},{cls:K,x:303,y:99},{cls:K,x:305,y:97},{cls:K,x:299,y:95},{cls:K,x:295,y:92},{cls:K,x:293,y:104}],timeOut:20},{spawners:[{cls:K,x:0,y:101},{cls:K,x:0,y:103},{cls:K,x:0,y:105},{cls:K,x:0,y:107},{cls:K,x:0,y:99},{cls:K,x:0,y:97},{cls:K,x:0,y:95},{cls:K,x:0,y:92},{cls:K,x:0,y:104},{cls:K,x:162,y:222},{cls:K,x:160,y:224},{cls:K,x:161,y:220},{cls:K,x:159,y:228},{cls:K,x:158,y:226},{cls:K,x:161,y:225},{cls:K,x:160,y:221},{cls:K,x:155,y:230},{cls:K,x:163,y:218}],timeOut:1/0},{spawners:[{cls:X,x:162,y:1},{cls:X,x:160,y:3},{cls:X,x:161,y:5},{cls:X,x:159,y:7},{cls:X,x:158,y:9},{cls:X,x:161,y:3},{cls:X,x:160,y:5},{cls:X,x:155,y:2},{cls:X,x:163,y:4}],timeOut:12},{spawners:[{cls:X,x:302,y:101},{cls:X,x:304,y:103},{cls:X,x:305,y:105},{cls:X,x:301,y:107},{cls:X,x:303,y:99},{cls:X,x:305,y:97},{cls:X,x:299,y:95},{cls:X,x:295,y:92},{cls:X,x:293,y:104}],timeOut:20},{spawners:[{cls:X,x:0,y:101},{cls:X,x:0,y:103},{cls:X,x:0,y:105},{cls:X,x:0,y:107},{cls:X,x:0,y:99},{cls:X,x:0,y:97},{cls:X,x:0,y:95},{cls:X,x:0,y:92},{cls:X,x:0,y:104}],timeOut:1/0},{spawners:[{cls:X,x:162,y:222},{cls:X,x:160,y:224},{cls:X,x:161,y:220},{cls:X,x:159,y:228},{cls:X,x:158,y:226},{cls:X,x:161,y:225},{cls:X,x:160,y:221},{cls:X,x:155,y:230},{cls:X,x:163,y:218}],timeOut:1/0},{spawners:[{cls:K,x:0,y:101},{cls:K,x:0,y:103},{cls:K,x:0,y:105},{cls:K,x:0,y:107},{cls:K,x:0,y:99},{cls:K,x:0,y:97},{cls:K,x:0,y:95},{cls:K,x:0,y:92},{cls:K,x:0,y:104},{cls:K,x:162,y:222},{cls:K,x:160,y:224},{cls:K,x:161,y:220},{cls:K,x:159,y:228},{cls:K,x:158,y:226},{cls:K,x:161,y:225},{cls:K,x:160,y:221},{cls:K,x:155,y:230},{cls:K,x:163,y:218},{cls:K,x:0,y:101},{cls:K,x:0,y:103},{cls:K,x:0,y:105},{cls:K,x:0,y:107},{cls:K,x:0,y:99},{cls:K,x:0,y:97},{cls:K,x:0,y:95},{cls:K,x:0,y:92},{cls:K,x:0,y:104},{cls:K,x:162,y:222},{cls:K,x:160,y:224},{cls:K,x:161,y:220},{cls:K,x:159,y:228},{cls:K,x:158,y:226},{cls:K,x:161,y:225},{cls:K,x:160,y:221},{cls:K,x:155,y:230},{cls:K,x:163,y:218},{cls:X,x:162,y:1},{cls:X,x:160,y:3},{cls:X,x:161,y:5},{cls:X,x:159,y:7},{cls:X,x:158,y:9},{cls:X,x:161,y:3},{cls:X,x:160,y:5},{cls:X,x:155,y:2},{cls:X,x:163,y:4},{cls:X,x:302,y:101},{cls:X,x:304,y:103},{cls:X,x:305,y:105},{cls:X,x:301,y:107},{cls:X,x:303,y:99},{cls:X,x:305,y:97},{cls:X,x:299,y:95},{cls:X,x:295,y:92},{cls:X,x:293,y:104},{cls:X,x:0,y:101},{cls:X,x:0,y:103},{cls:X,x:0,y:105},{cls:X,x:0,y:107},{cls:X,x:0,y:99},{cls:X,x:0,y:97},{cls:X,x:0,y:95},{cls:X,x:0,y:92},{cls:X,x:0,y:104},{cls:X,x:162,y:222},{cls:X,x:160,y:224},{cls:X,x:161,y:220},{cls:X,x:159,y:228},{cls:X,x:158,y:226},{cls:X,x:161,y:225},{cls:X,x:160,y:221},{cls:X,x:155,y:230},{cls:X,x:163,y:218}],timeOut:1/0}],initialEnemies:[{cls:X,x:162,y:1},{cls:X,x:160,y:3},{cls:X,x:161,y:5},{cls:X,x:159,y:7},{cls:X,x:158,y:9},{cls:X,x:302,y:101},{cls:X,x:304,y:103},{cls:X,x:305,y:105},{cls:X,x:301,y:107},{cls:X,x:303,y:99},{cls:X,x:0,y:101},{cls:X,x:0,y:103},{cls:X,x:0,y:105},{cls:X,x:0,y:107},{cls:X,x:0,y:99},{cls:X,x:162,y:222},{cls:X,x:160,y:224},{cls:X,x:161,y:220},{cls:X,x:159,y:228},{cls:X,x:158,y:226}],unwalkables:[],boss:{cls:class extends q{constructor(t,e){super({x:t,y:e},37,62,{offsetY:14,width:37,height:31},200,2,{down:M(p.getImage("lawnmower.down")),left:M(p.getImage("lawnmower.left")),up:M(p.getImage("lawnmower.up")),right:M(p.getImage("lawnmower.right")),accelDown:M(p.getImage("lawnmowerAccel.down")),accelLeft:M(p.getImage("lawnmowerAccel.left")),accelUp:M(p.getImage("lawnmowerAccel.up")),accelRight:M(p.getImage("lawnmowerAccel.right")),flamesDown:M(p.getImage("lawnmowerFlames.down")),flamesLeft:M(p.getImage("lawnmowerFlames.left")),flamesUp:M(p.getImage("lawnmowerFlames.up")),flamesRight:M(p.getImage("lawnmowerFlames.right"))},"down"),this.speed=500,this.canCollideWithTypes.add("playerProjectile"),this.vel={x:0,y:0},this.attackTimer=.75,this.target=null,this.attacking=!1,this.facing=0,this.attack=null}update(t){if(this.currentAnimation.update(t),this.attacking){if(null===this.attack||!this.attack.alive){let t,e,i={0:0};switch(this.facing){case 0:t=35,e=36,i={x:2,y:26};break;case 1:t=39,e=24,i={x:0,y:36};break;case 3:this.changeAnimation(this.animations.up),t=35,e=36,i={x:2,y:26};break;case 2:t=39,e=24,i={x:21,y:36}}this.attack=S.spawn(H,this,i,t,e),this.attack.damage=3}if(this.currentAnimation.id.startsWith("lawnmowerFlames")){if(!this.currentAnimation.playing)switch(this.facing){case 0:this.changeAnimation(this.animations.down);break;case 1:this.changeAnimation(this.animations.left);break;case 3:this.changeAnimation(this.animations.up);break;case 2:this.changeAnimation(this.animations.right)}}else this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),null!==this.attack&&this.attack.alive&&(this.attack.pos.x+=Math.round(this.vel.x*t),this.attack.pos.y+=Math.round(this.vel.y*t)),this.attacking=Math.hypot(this.pos.x-this.target.x,this.pos.y-this.target.y)>16}else if(this.attackTimer<=0){if(this.currentAnimation.id.startsWith("lawnmowerFlames")){if(!this.currentAnimation.playing){let t,e=Number.MAX_SAFE_INTEGER,i=null;const s={x:0,y:0};for(const s of[...S.liveEntities].filter((t=>"player"==t.type)))t=Math.hypot(s.pos.x-this.pos.x,s.pos.y-this.pos.y),t<e&&(e=t,i=s);this.target=Object.assign({},i.pos),this.attacking=!0,this.attackTimer=1.25*Math.random()+.75,s.x=this.target.x-this.pos.x,s.y=this.target.y-this.pos.y,s.y>0?this.facing=0:s.y<0&&(this.facing=3),s.x>Math.abs(s.y)?this.facing=2:s.x<0&&Math.abs(s.x)>Math.abs(s.y)&&(this.facing=1);const o=Math.hypot(s.x,s.y);this.vel.x=this.speed*s.x/o,this.vel.y=this.speed*s.y/o}}else if(!this.attacking)switch(this.facing){case 0:this.changeAnimation(this.animations.flamesDown);break;case 1:this.changeAnimation(this.animations.flamesLeft);break;case 3:this.changeAnimation(this.animations.flamesUp);break;case 2:this.changeAnimation(this.animations.flamesRight)}}else{if(this.attack&&this.attack.die(),!this.currentAnimation.id.startsWith("lawnmowerAccel"))switch(this.facing){case 0:this.changeAnimation(this.animations.accelDown);break;case 1:this.changeAnimation(this.animations.accelLeft);break;case 3:this.changeAnimation(this.animations.accelUp);break;case 2:this.changeAnimation(this.animations.accelRight)}this.attackTimer-=t}super.update(t)}onTopWallCollision(t){this.attacking=!1,super.onTopWallCollision(t)}onLeftWallCollision(t){this.attacking=!1,super.onLeftWallCollision(t)}onBottomWallCollision(t){this.attacking=!1,super.onBottomWallCollision(t)}onRightWallCollision(t){this.attacking=!1,super.onRightWallCollision(t)}},x:154,y:4}},{name:"Level 2",loaded:!1,complete:!1,started:!1,grids:[Ft,Dt,Gt],initialEnemies:[],waves:[{spawners:[{cls:K,x:320,y:96,amount:20},{cls:K,x:0,y:96,amount:20},{cls:K,x:224,y:0,amount:20},{cls:K,x:192,y:320,amount:20},{cls:K,x:320,y:96,amount:20},{cls:K,x:0,y:96,amount:20},{cls:K,x:224,y:0,amount:20},{cls:K,x:192,y:320,amount:20}],timeOut:1/0},{spawners:[{cls:K,x:320,y:96,amount:30},{cls:K,x:0,y:96,amount:30},{cls:K,x:224,y:0,amount:30},{cls:K,x:192,y:320,amount:30}],timeOut:1/0},{spawners:[{cls:K,x:320,y:96,amount:50},{cls:K,x:0,y:96,amount:50},{cls:K,x:224,y:0,amount:50},{cls:K,x:192,y:320,amount:50}],timeOut:20},{spawners:[{cls:Y,x:320,y:96,amount:20},{cls:Y,x:0,y:96,amount:20},{cls:Y,x:224,y:0,amount:20},{cls:Y,x:192,y:320,amount:20}],timeOut:20}],unwalkables:[{x:0,y:0,width:176,height:32},{x:240,y:0,width:64,height:32},{x:304,y:0,width:jt,height:96},{x:0,y:32,width:32,height:64},{x:0,y:128,width:jt,height:112},{x:304,y:128,width:jt,height:112}],boss:{cls:class extends q{constructor(t,e){super({x:t,y:e},32,48,{offsetY:0,width:32,height:48},250,3,{wake:M(p.getImage("fridge.wake")),idlel:M(p.getImage("fridge.idlel")),idler:M(p.getImage("fridge.idler")),idlem:M(p.getImage("fridge.idlem")),shootl:M(p.getImage("fridge.shootl")),shootr:M(p.getImage("fridge.shootr")),shootm:M(p.getImage("fridge.shootm")),aimltr:M(p.getImage("fridge.aim.ltr")),aimltm:M(p.getImage("fridge.aim.ltm")),aimmtl:M(p.getImage("fridge.aim.mtl")),aimmtr:M(p.getImage("fridge.aim.mtr")),aimrtl:M(p.getImage("fridge.aim.rtl")),aimrtm:M(p.getImage("fridge.aim.rtm"))},"idlel"),this.speed=150,this.canCollideWithTypes.add("playerProjectile"),this.vel={x:0,y:0},this.target=null,this.attacking=!1,this.attackTimer=1.25,this.projectileAttacking=!1,this.projectileAttackTimer=1,this.projectileAttackIndex=0,this.projectileAttackAfterTurns=3,this.shotTimer=0}update(t){if(this.currentAnimation.update(t),this.projectileAttacking){if(this.shotTimer<=0){var e={x:0,y:0};e.x=this.target.x-this.pos.x,e.y=this.target.y-this.pos.y;var i=Math.hypot(e.x,e.y);NaN===i&&(i=0),i?(this.vel.x=this.speed*e.x/i,this.vel.y=this.speed*e.y/i):(this.vel.x=0,this.vel.y=0);var s=[this.speed,this.speed,0,-this.speed,-this.speed,-this.speed,0,this.speedaas],o=[0,this.speed,this.speed,this.speed,0,-this.speed,-this.speed,-this.speed],a=[this.animations.aimltm,this.animations.aimltr,this.animations.aimltm,this.animations.aimmtl,this.animations.aimmtr,this.animations.aimrtl,this.animations.aimrtm,this.animations.aimrtl];this.vel.x=s[this.projectileAttackIndex],this.vel.y=o[this.projectileAttackIndex],this.currentAnimation=a[this.projectileAttackIndex],this.projectileAttackIndex++,this.projectileAttackIndex>=s.length&&(this.projectileAttackIndex=0),S.spawn(z,this.pos.x+this.width/2,this.pos.y+this.height/2,0,0,this.vel.x,this.vel.y,M(p.getImage("icecube.dflt"))),this.shotTimer=.1}else this.shotTimer-=t;this.projectileAttackTimer-=t,this.projectileAttackTimer<=0&&(this.projectileAttacking=!1,this.projectileAttackIndex=0)}else if(this.attacking)this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),this.attacking=Math.hypot(this.pos.x-this.target.x,this.pos.y-this.target.y)>20;else if(this.attackTimer<=0){this.vel.x=0,this.vel.y=0;let t,e=Number.MAX_SAFE_INTEGER,i=null;const s={x:0,y:0};for(const s of[...S.liveEntities].filter((t=>"player"==t.type)))t=Math.hypot(s.pos.x-this.pos.x,s.pos.y-this.pos.y),NaN===t&&(t=0),t<e&&(e=t,i=s);if(this.target=Object.assign({},i.pos),this.projectileAttackAfterTurns>0){this.attacking=!0,this.attackTimer=.25*Math.random()+.5,s.x=this.target.x-this.pos.x,s.y=this.target.y-this.pos.y;const t=Math.hypot(s.x,s.y);NaN===t&&(t=0),t?(this.vel.x=this.speed*s.x/t,this.vel.y=this.speed*s.y/t):(this.vel.x=0,this.vel.y=0),this.projectileAttackAfterTurns--}else this.projectileAttacking=!0,this.projectileAttackTimer=1,this.projectileAttackAfterTurns=3}else this.attackTimer-=t;(this.vel.y>0||this.vel.y<0)&&(this.currentAnimation=this.animations.idlem),this.vel.x>Math.abs(this.vel.y)?this.currentAnimation=this.animations.idler:this.vel.x<0&&Math.abs(this.vel.x)>Math.abs(this.vel.y)&&(this.currentAnimation=this.animations.idlel),super.update(t)}onTopWallCollision(t){this.attacking=!1,super.onTopWallCollision(t)}onLeftWallCollision(t){this.attacking=!1,super.onLeftWallCollision(t)}onBottomWallCollision(t){this.attacking=!1,super.onBottomWallCollision(t)}onRightWallCollision(t){this.attacking=!1,super.onRightWallCollision(t)}},x:177,y:1}},{name:"Level 3",loaded:!1,complete:!1,started:!1,grids:[zt,Qt,$t],initialEnemies:[],waves:[{spawners:[{cls:Y,x:1,y:104,amount:10},{cls:Y,x:152,y:24,amount:10},{cls:Y,x:320,y:104,amount:10},{cls:Y,x:160,y:216,amount:10}],timeOut:10},{spawners:[{cls:Y,x:1,y:104,amount:6},{cls:Y,x:152,y:24,amount:6},{cls:Y,x:320,y:104,amount:6},{cls:Y,x:160,y:216,amount:6},{cls:K,x:1,y:104,amount:16},{cls:K,x:152,y:24,amount:16},{cls:K,x:320,y:104,amount:16},{cls:K,x:160,y:216,amount:16}],timeOut:1/0},{spawners:[{cls:Y,x:1,y:104,amount:12},{cls:Y,x:152,y:24,amount:12},{cls:Y,x:320,y:104,amount:12},{cls:Y,x:160,y:216,amount:12}],timeOut:4},{spawners:[{cls:K,x:1,y:104,amount:18},{cls:K,x:152,y:24,amount:18},{cls:K,x:320,y:104,amount:18},{cls:K,x:160,y:216,amount:18}],timeOut:5},{spawners:[{cls:K,x:1,y:104,amount:3},{cls:K,x:152,y:24,amount:3},{cls:K,x:320,y:104,amount:3},{cls:K,x:160,y:216,amount:3}],timeOut:2},{spawners:[{cls:K,x:1,y:104,amount:3},{cls:K,x:152,y:24,amount:3},{cls:K,x:320,y:104,amount:3},{cls:K,x:160,y:216,amount:3}],timeOut:2},{spawners:[{cls:K,x:1,y:104,amount:6},{cls:K,x:152,y:24,amount:6},{cls:K,x:320,y:104,amount:6},{cls:K,x:160,y:216,amount:6}],timeOut:2}],unwalkables:[{x:0,y:0,width:80,height:32},{x:80,y:0,width:32,height:jt},{x:112,y:0,width:32,height:32},{x:144,y:0,width:32,height:jt},{x:176,y:0,width:128,height:32},{x:320,y:0,width:jt,height:96},{x:0,y:32,width:jt,height:64},{x:0,y:128,width:jt,height:32},{x:0,y:160,width:24,height:64},{x:0,y:208,width:jt,height:32},{x:320,y:128,width:jt,height:32},{x:296,y:160,width:24,height:64},{x:320,y:208,width:jt,height:32}],boss:{cls:class extends q{constructor(t,e){super({x:t,y:e},64,40,{width:64,height:40},300,4,{idle:M(p.getImage("tv.idle")),att:M(p.getImage("tv.att"))},"idle"),this.speed=300,this.canCollideWithTypes.add("playerProjectile"),this.vel={x:0,y:0},this.attackTimer=3,this.target=null,this.attacking=!1,this.attack=null}update(t){if(this.currentAnimation.playing||this.currentAnimation.play(),this.currentAnimation.update(t),this.attacking)this.pos.x+=Math.round(this.vel.x*t),this.pos.y+=Math.round(this.vel.y*t),this.attacking=Math.hypot(this.pos.x-this.target.x,this.pos.y-this.target.y)>20,this.currentAnimation=this.animations.att;else if(this.attackTimer<=0){this.vel.x=0,this.vel.y=0;let t,e=Number.MAX_SAFE_INTEGER,i=null;const s={x:0,y:0};for(const s of[...S.liveEntities].filter((t=>"player"==t.type)))t=Math.hypot(s.pos.x-this.pos.x,s.pos.y-this.pos.y),NaN===t&&(t=0),t<e&&(e=t,i=s);this.target=Object.assign({},i.pos),this.attacking=!0,this.attackTimer=3-1*Math.random(),s.x=this.target.x-this.pos.x,s.y=this.target.y-this.pos.y;const o=Math.hypot(s.x,s.y);NaN===o&&(o=0),o?(this.vel.x=this.speed*s.x/o,this.vel.y=this.speed*s.y/o):(this.vel.x=0,this.vel.y=0)}else this.currentAnimation=this.animations.idle,this.attackTimer-=t;super.update(t)}onTopWallCollision(t){this.attacking=!1,super.onTopWallCollision(t)}onLeftWallCollision(t){this.attacking=!1,super.onLeftWallCollision(t)}onBottomWallCollision(t){this.attacking=!1,super.onBottomWallCollision(t)}onRightWallCollision(t){this.attacking=!1,super.onRightWallCollision(t)}},x:110,y:216}},{name:"Level 4",loaded:!1,complete:!1,started:!1,grids:[me,ge],initialEnemies:[],waves:[{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:2},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:3},{cls:K,x:128,y:24,amount:3},{cls:K,x:320,y:104,amount:3},{cls:K,x:160,y:216,amount:3}],timeOut:2},{spawners:[{cls:K,x:1,y:104,amount:16},{cls:K,x:128,y:24,amount:16},{cls:K,x:320,y:104,amount:16},{cls:K,x:160,y:216,amount:16}],timeOut:1/0},{spawners:[{cls:K,x:1,y:104,amount:32},{cls:K,x:128,y:24,amount:32},{cls:K,x:320,y:104,amount:32},{cls:K,x:160,y:216,amount:32}],timeOut:1/0},{spawners:[{cls:K,x:1,y:104,amount:48},{cls:K,x:128,y:24,amount:48},{cls:K,x:320,y:104,amount:48},{cls:K,x:160,y:216,amount:48}],timeOut:1/0},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1},{spawners:[{cls:K,x:1,y:104,amount:2},{cls:K,x:128,y:24,amount:2},{cls:K,x:320,y:104,amount:2},{cls:K,x:160,y:216,amount:2}],timeOut:1/0},{spawners:[{cls:K,x:1,y:104,amount:64},{cls:K,x:128,y:24,amount:64},{cls:K,x:320,y:104,amount:64},{cls:K,x:160,y:216,amount:64}],timeOut:1/0}],unwalkables:[{x:0,y:0,width:112,height:32},{x:144,y:0,width:44,height:32},{x:244,y:0,width:64,height:32},{x:320,y:0,width:jt,height:96},{x:0,y:32,width:32,height:56},{x:0,y:128,width:jt,height:112},{x:320,y:128,width:jt,height:112}],boss:{cls:class extends V{constructor(t,e){super({x:t,y:e},51,67,{width:51,height:67},400,6,{idle:M(p.getImage("washer.idle")),preJump:M(p.getImage("washer.preJump")),jump:M(p.getImage("washer.jump")),stomp:M(p.getImage("washer.stomp")),open:M(p.getImage("washer.open")),close:M(p.getImage("washer.close"))},"idle",120,.75,48,"washer.preJump","jump","stomp")}getPreJumpAnim(){return this.animations.preJump}},x:190,y:1}}];class _e extends L{constructor(t){const e=t.x,i=t.y,s=t.width,o=t.height;super("unwalkable",{x:e,y:i},s,o,{x:e,y:i,width:s,height:o},1/0),this.canCollideWithTypes.add("player"),this.canCollideWithTypes.add("enemy")}reset(t){this.pos.x=this.collider.x=t.x,this.pos.y=this.collider.y=t.y,this.width=this.collider.width=t.width,this.height=this.collider.height=t.height}draw(){window.debugMode&&(t.context.fillStyle="cyan",t.context.fillRect(this.collider.x,this.collider.y,this.collider.width,this.collider.height))}}class ke extends L{constructor(e,i){super("credit",{x:t.canvas.width/2,y:t.canvas.height},0,0,{},1/0,0,{},""),this.reset(e,i)}setUpContext(){const e=t.context;e.save(),e.textAlign="center",e.font="12px serif",e.fillStyle="cyan"}restoreContext(){t.context.restore()}setDimensions(){this.setUpContext();const e=t.context.measureText(this.text);this.width=e.width,this.height=e.actualBoundingBoxAscent,this.restoreContext()}reset(e,i){this.text=e,this.timeTilNextLine=i,this.setDimensions(),super.reset(t.canvas.width/2,t.canvas.height+this.height)}update(t){this.pos.y-=Math.max(Math.round(1*t),1),this.pos.y+this.height<0&&this.die()}draw(){const e=t.context;this.setUpContext(),e.fillText(this.text,this.pos.x,this.pos.y),this.restoreContext()}}class ve extends ke{setUpContext(){super.setUpContext(),t.context.font="bold 20px serif"}reset(t,e){super.reset(t,e+1/8)}}const be={"Gonzalo Delgado":["Project lead, core gameplay, enemy AI & pathfinding, sound","code, sounds, waves, broom attack animation integration,","lawnmower boss (art and code), pickups, washing machine art","and animation, book enemy sprites, lawnmower flame animation,","gardening shovel enemy, different gun support, gun spread,","ammo limit, gun items, level skip cheat, game reset, rolling","credits support, game over scene, death poof, laser gun,","level progression implementation, player death animation,","player sprites, game end logic"],"Tylor Allison":["Room design and tile art (yard, kitchen, living room, laundry","room), level grid implementation, tile layering, subtile","support, animated tile support, fridge boss animations and","taunts, ice cube animation integration, teapot animation,","title screen and related transitions"],"Andrew Mushel":["Player and shot velocity fixes, lifebar, lives display, dash","ability gamepad support, player animation refactor, broom walk","and attack animations"],"Bilal A. Cheema":["Fridge boss ice cube attacks, fridge attack animation, level 3,","TV boss animation and integration"],"Rutger McKenna":["Menu icons (potion, pentagram, crystal ball, cauldron,","necronomicon), projectile sprites"],"Grygoriy Kulesko":["Book enemy animation integration, pause feature including","overlay and recovery time"],"Ashleigh M.":["Witch llama concept draft"],"Antonio Malafronte":["Mute functionality"],"H Trayford":["Placeholder description of keyboard controls"],"Chris DeLeon":["Compiled credits"],"Wesley Stagg":["Practice commit (welcome to HomeTeam!)"]};let Ae;class Te{constructor(){}init(){}reset(){return this}draw(){}update(t){v.update(t)}switchTo(t){v.reset(),Ae=t,Ae.reset()}}const Ie=1/4,Me={attract:new class extends Te{reset(){return S.reset(),v.reset(),v.on(["start"],(t=>{this.switchTo(Me.select)})),v.on("credits",(()=>{this.switchTo(Me.credits)})),super.reset()}setup(){this.titleSprite||(this.titleSprite=M(p.getImage("title")),this.textAlpha=1,this.textAlphaTTL=1,this.textFadeOut=!0,this.bgSprites=[M(p.getImage("necro")),M(p.getImage("pentagram")),M(p.getImage("crystalball")),M(p.getImage("cauldron2")),M(p.getImage("potion"))],this.bgx=Math.floor(Math.random()*t.canvas.width),this.bgy=Math.floor(Math.random()*t.canvas.height),this.bgi=0,this.bgAlpha=0,this.bgTTL=1.5,this.bgFadeOut=!1)}draw(){this.setup(),t.context.fillStyle="rgb(30, 17, 36)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height);const e=this.bgSprites[this.bgi],i=this.bgx-.5*e.width,s=this.bgy-.5*e.height;t.context.globalAlpha=this.bgAlpha,e.draw(t.context,i,s),t.context.globalAlpha=1,this.titleSprite.draw(t.context),t.context.fillStyle="rgb(153,229,80, "+this.textAlpha+")",t.context.textAlign="center",t.context.fillText('HIT "ENTER" KEY TO START PLAYING',t.canvas.width/2,.96*t.canvas.height),t.context.fillText('HIT "C" KEY TO SEE CREDITS',t.canvas.width/2,.91*t.canvas.height),t.context.textAlign="left"}update(e){super.update(e),this.textFadeOut?(this.textAlpha-=e/this.textAlphaTTL,this.textAlpha<=0&&(this.textAlpha=0,this.textFadeOut=!1)):(this.textAlpha+=e/this.textAlphaTTL,this.textAlpha>=1&&(this.textAlpha=1,this.textFadeOut=!0)),this.bgFadeOut?(this.bgAlpha-=e/this.bgTTL,this.bgAlpha<=0&&(this.bgAlpha=0,this.bgFadeOut=!1,this.bgi++,this.bgx=Math.floor(Math.random()*t.canvas.width),this.bgy=Math.floor(Math.random()*t.canvas.height),this.bgi>=this.bgSprites.length&&(this.bgi=0))):(this.bgAlpha+=e/this.bgTTL,this.bgAlpha>=1&&(this.bgAlpha=1,this.bgFadeOut=!0))}},select:new class extends Te{constructor(){super(),this.slots=[{input:null,sprite:"player1.select",animation:null,selected:!1},{input:null,sprite:"player2.select",animation:null,selected:!1}],this.skippedGamePadStart=!1}selectSlot(t,e,i){t.selected=!0;const s=t.input;t.input=i,e.input==t.input&&(e.input=s,e.selected=null!=s)}reset(){return this.skippedGamePadStart=!1,this.slots[0].input=v.primaryControl,this.slots[0].selected=!0,v.on("gamepadConnected",(t=>{for(const e of this.slots)if(!e.selected)return e.selected=!0,void(e.input=t)})),v.on("left",(t=>{this.selectSlot(this.slots[0],this.slots[1],t)})),v.on("right",(t=>{this.selectSlot(this.slots[1],this.slots[0],t)})),v.on("start",(e=>{if(!e.name.startsWith("Gamepad")||e!=v.primaryControl||this.skippedGamePadStart)if(this.slots.filter((t=>t.input===e)).length){for(let e=0;e<this.slots.length;e++)if(this.slots[e].selected){const i=this.slots[e].input,s=S.spawn(W,i,e*(t.canvas.width-20),t.canvas.height/2-20,"player"+(e+1),0==e?"right":"left");s.lives=3,i.player=s}this.switchTo(Me.game)}else for(const t of this.slots.filter((t=>!t.selected))){t.input=e,t.selected=!0;break}else this.skippedGamePadStart=!0})),super.reset()}update(t){super.update(t);for(const e of this.slots)null!==e.animation&&e.animation.update(t)}draw(){t.context.fillStyle="rgb(0, 64, 88)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height),t.context.fillStyle="white";const e=t.canvas.width/this.slots.length-5;this.slots.forEach(((i,s)=>{t.context.lineWidth=10,t.context.strokeStyle=i.selected?"lime":"orange",t.context.strokeRect(s*e+5,5,(s+1)*e-5,t.canvas.height-5),null!=i.input&&(t.context.fillStyle="white",t.context.fillText(i.input.name,50+Math.round(t.canvas.width/2)*s,Math.round(t.canvas.height/2)),t.context.fillText(i.input.cntrls1,30+Math.round(t.canvas.width/2)*s,Math.round(t.canvas.height/2+30)),t.context.fillText(i.input.cntrls2,30+Math.round(t.canvas.width/2)*s,Math.round(t.canvas.height/2+60)),t.context.fillText(i.input.cntrls3,30+Math.round(t.canvas.width/2)*s,Math.round(t.canvas.height/2+90))),null===i.animation&&(i.animation=M(p.getImage(i.sprite)),i.animation.play()),i.animation.draw(t.context,t.canvas.width/4+s*t.canvas.width/2,50)}))}},game:new class extends Te{constructor(){super(),S.onCollision("playerProjectile","enemy",((t,e)=>{e.hurt(t.damage),t.hurt(1)})),S.onCollision("enemyProjectile","player",((t,e)=>{e.hurt(t.damage),t.die()})),S.onCollision("enemyAttack","player",((t,e)=>{e.invincible||e.crying||(e.hurt(t.damage),t.damage=0)})),S.onCollision("pickup","player",((t,e)=>{t.apply(e),t.die()})),S.onCollision("unwalkable","player",((t,e)=>{const i=e.collider.x+e.collider.width>t.collider.x+t.collider.width||e.collider.x<t.collider.x,s=e.collider.y+e.collider.height>t.collider.y+t.collider.height||e.collider.y<t.collider.y;i&&(e.pos.x=e.prevPos.x,e.vel.x=0),s&&(e.pos.y=e.prevPos.y,e.vel.y=0)})),S.onCollision("unwalkable","enemy",((t,e)=>{if(e instanceof q)return;const i=e.collider.x+e.collider.width>t.collider.x+t.collider.width||e.collider.x<t.collider.x,s=e.collider.y+e.collider.height>t.collider.y+t.collider.height||e.collider.y<t.collider.y;i&&(e.pos.x=e.prevPos.x,e.vel.x=0),s&&(e.pos.y=e.prevPos.y,e.vel.y=0)})),this.reset()}setUpInput(){for(let t=0;t<we.length;t++)v.on("warpToLevel"+(t+1),(e=>{we[this.levelIndex].loaded=!1,we[this.levelIndex].started=!1,this.waveTimeOut=1/0,this.boss=null,this.levelIndex=t}))}reset(){this.setUpInput(),this.levelIndex=0,this.waveTimeOut=1/0,this.boss=null,this.gameOverTimer=0,this.levelCompleteTimer=0;for(const t of we)t.loaded=!1,t.complete=!1,t.started=!1;return super.reset()}loadLevel(){const t=we[this.levelIndex],e=S.getLiveForType("player");t.started=!1,t.complete=!1;for(const t of["enemy","enemyProjectile","playerProjectile","enemyAttack","pickup","gun","unwalkable"])for(const e of S.getLiveForType(t))e.die();for(const t of e)t.reset(t.controller,t.initialPos.x,t.initialPos.y,t.spriteId),t.setBasicGun();this.gridViews=t.grids.map((t=>new T(t,p)));for(const e of t.initialEnemies)S.spawn(e.cls,e.x,e.y);for(const e of t.unwalkables)S.spawn(_e,e);this.waves=Array.from(t.waves),t.loaded=!0,this.boss=null,this.levelCompleteTimer=0}update(t){super.update(t);const e=we[this.levelIndex];if(e.loaded){if(e.started){this.gridViews.forEach((e=>e.update(t)));const i=[...S.liveEntities].filter((t=>"enemy"==t.type));if(this.waveTimeOut<=0||i.length<=0)if(this.waves.length>0){const t=this.waves.shift();this.waveTimeOut=t.timeOut;for(const e of t.spawners)Array(e.amount).fill().forEach((()=>{S.spawn(e.cls,e.x,e.y)}))}else i.length<=0&&null==this.boss?this.boss=S.spawn(e.boss.cls,e.boss.x,e.boss.y):null==this.boss||this.boss.alive||(we[this.levelIndex].complete=!0,this.levelCompleteTimer>=3+(this.levelIndex>=we.length-1?2:0)?this.levelIndex<we.length-1?(we[this.levelIndex].loaded=!1,this.levelIndex++,this.loadLevel()):this.switchTo(Me.credits):this.levelCompleteTimer+=t);else S.getLiveForType("player").length<=0&&(this.gameOverTimer>3&&this.switchTo(Me.gameOver),this.gameOverTimer+=t),1-Math.random()<.005&&S.spawn(G[Math.floor(Math.random()*G.length)])}else e.started=!S.getLiveForType("player").map((t=>t.enteringStage)).reduce(((t,e)=>t&&e),!0);S.update(t)}else this.loadLevel();this.waveTimeOut-=t}draw(){const e=we[this.levelIndex];if(!e.loaded)return t.context.fillStyle="rgb(0, 64, 88)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height),t.context.fillStyle="white",void t.context.fillText("LOADING ...",10,t.canvas.height/2);this.gridViews.forEach((e=>{e.properties.fg||e.draw(t.context)})),S.draw(),this.gridViews.forEach((e=>{e.properties.fg&&e.draw(t.context)}));for(const e of[...S.liveEntities].filter((t=>"player"==t.type))){let i=10,s=10;t.context.fillStyle="red",t.context.fillRect(10,10,50,10),t.context.fillStyle="green",t.context.fillRect(10,10,e.hp/10*50,10),i+=50,s+=5;const o=document.createElement("canvas");let a=e.currentAnimation;const n=a.width,h=a.height;o.context=o.getContext("2d"),o.width=n,o.height=h,a.draw(o.context,0,0),t.context.drawImage(o,i,s-h/4,n/2,h/2),i+=n/2,t.context.fillStyle="white",t.context.textBaseline="middle",t.context.fillText("x"+e.lives,i,s)}e.complete&&(t.context.save(),t.context.textAlign="center",this.levelIndex>=we.length-1?(t.context.font="bold 24px sans",t.context.fillStyle="red",t.context.fillText("CONGRATULATIONS!!",t.canvas.width/2,t.canvas.height/2),t.context.font="bold 18px sans",t.context.fillText("You finished the game!!",t.canvas.width/2,t.canvas.height/2+30)):(t.context.font="bold 20px sans",t.context.fillStyle="purple",t.context.fillText("LEVEL COMPLETE!",t.canvas.width/2,t.canvas.height/2)),t.context.restore())}},gameOver:new class extends Te{reset(){return this.timer=0,super.reset()}update(t){super.update(t),this.timer>=3?this.switchTo(Me.attract):this.timer+=t}draw(){t.context.save(),t.context.fillStyle="rgb(0, 64, 88)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height),t.context.textAlign="center",t.context.fillStyle="white",t.context.fillText("GAME OVER!",t.canvas.width/2,t.canvas.height/2),t.context.restore()}},credits:new class extends Te{*generateLines(){for(const[t,e]of Object.entries(be)){yield S.spawn(ve,t,Ie);for(let t=0;t<e.length;t++){const i=Ie;yield S.spawn(ke,e[t],t==e.length-1?2*i:i)}}}update(t){if(super.update(t),this.timer>=this.timeTilNextLine){const t=this.lines.next().value;void 0!==t&&(this.timer=0,this.timeTilNextLine=t.timeTilNextLine)}this.timer+=t;for(const e of S.getLiveForType("credit"))e.update(t);S.getLiveForType("credit").length<=0&&this.switchTo(Me.attract)}reset(){v.on(["start"],(t=>{this.switchTo(Me.attract)})),this.timer=Ie,this.timeTilNextLine=Ie;for(const t of S.getLiveForType("credit"))t.die();for(const t of S.getLiveForType("player"))t.die();return this.lines=this.generateLines(),super.reset()}draw(){super.draw(),t.context.save(),t.context.fillStyle="rgb(0, 64, 88)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height),t.context.restore();for(const t of S.getLiveForType("credit"))t.draw()}}};Ae=Me.attract,Ae.reset();let Se=0,Le=Re();const Ce=1/60;window.debugMode=!1,window.mute=!1,window.paused=!1;let Oe=0;function je(e){if(Se+=Math.min(1,(e-Le)/1e3),window.paused)for(;Se>Ce;)Se-=Ce,v.update(Se);else for(;Se>Ce;)Se-=Ce,Ae.update(Ce);Ae.draw(),window.paused&&(t.context.fillStyle="rgba(0, 0, 0, .5)",t.context.fillRect(0,0,t.canvas.width,t.canvas.height),t.context.fillStyle="white",t.context.fillText("Paused",10,t.canvas.height/2)),Le=e,window.requestAnimationFrame(je)}function Re(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function Ee(t){Ae.init(),window.requestAnimationFrame(je)}window.onload=function(){t.canvas=document.getElementById(t.id),t.context=t.canvas.getContext("2d"),v.initialize(),p.loadAssets().then(Ee)},window.pauseGame=function(){let t=Re();Oe<=t&&(window.paused=!window.paused,Oe=window.paused?t+150:t+250)}})();